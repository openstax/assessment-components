{"version":3,"file":"index.modern.mjs","sources":["../src/components/Answer.tsx"],"sourcesContent":["import cn from 'classnames';\nimport { ReactNode } from 'react';\n\nconst ALPHABET = 'abcdefghijklmnopqrstuvwxyz';\n\nconst isAnswerCorrect = function(answer: answerType, correctAnswerId: idType) {\n  // if answer does not have an id, check the isCorrect property.\n  if (!(answer.id || correctAnswerId)) {\n    return answer.isCorrect;\n  }\n  let isCorrect = answer.id === correctAnswerId;\n  if (answer.correctness != null) { isCorrect = (answer.correctness === '1.0'); }\n\n  return isCorrect;\n};\n\nconst isAnswerIncorrect = function(answer: answerType, incorrectAnswerId: idType) {\n  // Allow multiple attempts to show incorrectness without the correct_answer_id\n  return answer.id === incorrectAnswerId;\n};\n\nconst isAnswerChecked = (answer: answerType, chosenAnswer: AnswerProps['chosenAnswer']) =>\n  Boolean((chosenAnswer || []).find( a => a == answer.id));\n\ntype answerType = {\n  id: idType;\n  correctness: string;\n  isCorrect: boolean;\n  content_html: string;\n  selected_count?: number;\n};\ntype idType = string | number;\n\ninterface AnswerProps {\n  answer: answerType;\n  iter: number;\n  qid: idType;\n  type: 'teacher-review' | 'teacher-preview' | 'student' | 'student-mpp';\n  hasCorrectAnswer: boolean;\n  onChangeAnswer: () => void;\n  disabled: boolean;\n  chosenAnswer: (string | null | undefined)[];\n  correctAnswerId: idType;\n  incorrectAnswerId: idType;\n  answered_count: number;\n  show_all_feedback: boolean;\n  keyControl: string | number | [];\n  onKeyPress: () => void;\n  children?: ReactNode;\n  correctIncorrectIcon?: ReactNode,\n  radioBox?: ReactNode;\n  selectedCount: any;\n  isCorrect: any;\n  isIncorrect: any;\n  feedback?: any;\n}\n\nexport const Answer = (props: AnswerProps) => {\n  const {\n    type,\n    iter,\n    answer,\n    disabled,\n    onKeyPress,\n    qid,\n    chosenAnswer,\n    correctAnswerId,\n    incorrectAnswerId,\n    hasCorrectAnswer,\n    answered_count,\n    children,\n    feedback\n  } = props;\n\n  let body, selectedCount;\n\n  const isChecked = isAnswerChecked(answer, chosenAnswer);\n  const isCorrect = isAnswerCorrect(answer, correctAnswerId);\n  const isIncorrect = isAnswerIncorrect(answer, incorrectAnswerId);\n\n  const correctIncorrectIcon = (\n    <div className=\"correct-incorrect\">\n      {isCorrect && props.correctIncorrectIcon}\n    </div>\n  );\n\n  const classes = cn('answers-answer', {\n    'disabled': disabled,\n    'answer-checked': isChecked,\n    'answer-correct': isCorrect && type !== 'student-mpp',\n    'answer-incorrect': isAnswerIncorrect(answer, incorrectAnswerId),\n  });\n\n  let ariaLabel = `${isChecked ? 'Selected ' : ''}Choice ${ALPHABET[iter]}`;\n  // somewhat misleading - this means that there is a correct answer,\n  // not necessarily that this answer is correct\n  if (hasCorrectAnswer) {\n    ariaLabel += `(${isCorrect ? 'Correct' : 'Incorrect'} Answer)`;\n  }\n  ariaLabel += ':';\n\n  let onChangeAnswer, radioBox;\n\n  if (!hasCorrectAnswer\n    && (type !== 'teacher-review')\n    && (type !== 'teacher-preview')\n    && (type !== 'student-mpp')) {\n    ({ onChangeAnswer } = props);\n  }\n\n  if (onChangeAnswer) {\n    radioBox = (\n      <input\n        type=\"radio\"\n        className=\"answer-input-box\"\n        checked={isChecked}\n        id={`${qid}-option-${iter}`}\n        name={`${qid}-options`}\n        onChange={onChangeAnswer}\n        disabled={disabled}\n      />\n    );\n  }\n  if (type === 'teacher-review' && answer.selected_count) {\n    const percent = Math.round((answer.selected_count / answered_count) * 100) || 0;\n    selectedCount = (\n      <span\n        className=\"selected-count\"\n        data-percent={`${percent}`}\n      >\n        {answer.selected_count}\n      </span>\n    );\n  }\n\n  if (type === 'teacher-review') {\n    body = (\n      <div className=\"review-wrapper\">\n        <div className={cn('review-count', { 'green': isCorrect, 'red': !isCorrect })}>\n          {selectedCount}\n          <span className={cn('letter', { 'green': isCorrect, 'red': !isCorrect })}>\n            {ALPHABET[iter]}\n          </span>\n        </div>\n\n        <div className=\"answer-answer\">\n          <div className=\"answer-content\">\n            {children}\n          </div>\n          {feedback}\n        </div>\n      </div>\n    );\n  } else {\n    body = (\n      <>\n        {type === 'teacher-preview' && correctIncorrectIcon}\n        {selectedCount}\n        {radioBox}\n        <label\n          onKeyPress={onKeyPress}\n          htmlFor={`${qid}-option-${iter}`}\n          className=\"answer-label\">\n          <span className=\"answer-letter-wrapper\">\n            <button\n              onClick={onChangeAnswer}\n              aria-label={ariaLabel}\n              className=\"answer-letter\"\n              disabled={disabled || isIncorrect}\n              data-test-id={`answer-choice-${ALPHABET[iter]}`}\n            >\n              {ALPHABET[iter]}\n            </button>\n          </span>\n          <div className=\"answer-answer\">\n            <div className=\"answer-content\">\n              {children}\n            </div>\n            {feedback}\n          </div>\n        </label>\n      </>\n    );\n  }\n\n  return (\n    <div className=\"openstax-answer\">\n      <section role=\"region\" className={classes}>\n        {body}\n      </section>\n    </div>\n  );\n}\nAnswer.displayName = 'OSAnswer';\n"],"names":["ALPHABET","isAnswerIncorrect","answer","incorrectAnswerId","id","Answer","props","type","iter","disabled","onKeyPress","qid","chosenAnswer","correctAnswerId","hasCorrectAnswer","answered_count","children","feedback","body","selectedCount","isChecked","Boolean","find","a","isAnswerChecked","isCorrect","correctness","isAnswerCorrect","isIncorrect","correctIncorrectIcon","_jsx","className","classes","cn","radioBox","ariaLabel","onChangeAnswer","checked","name","onChange","selected_count","percent","Math","round","_jsxs","green","red","_Fragment","htmlFor","onClick","role","displayName"],"mappings":"0FAGA,MAAMA,EAAW,6BAaMC,EAAG,SAASC,EAAoBC,GAErD,OAAaD,EAACE,KAAOD,GAuCJE,EAAIC,IACrB,MAAMC,KACJA,EADIC,KAEJA,EAFIN,OAGJA,EAHIO,SAIJA,EAJIC,WAKJA,EALIC,IAMJA,EANIC,aAOJA,EAPIC,gBAQJA,EARIV,kBASJA,EATIW,iBAUJA,EAVIC,eAWJA,EAXIC,SAYJA,EAZIC,SAaJA,GACEX,EAEJ,IAAIY,EAAMC,EAEV,MAAeC,EAvDO,EAAClB,EAAoBU,IAC3CS,SAAST,GAAgB,IAAIU,KAAMC,GAAKA,GAAKrB,EAAOE,KAsDlCoB,CAAgBtB,EAAQU,KAvEpB,SAASV,EAAoBW,GAEnD,IAAMX,EAAOE,KAAMS,EACjB,SAAcY,UAEhB,IAAIA,EAAYvB,EAAOE,KAAOS,EAG9B,OAF0B,MAAtBX,EAAOwB,cAAuBD,EAAoC,QAAvBvB,EAAOwB,eAkEpCC,CAAgBzB,EAAQW,GACpCe,EAAc3B,EAAkBC,EAAQC,GAEpB0B,EACxBC,EAAA,MAAA,CAAKC,UAAU,oBACZf,SAAAS,GAAanB,EAAMuB,uBAIXG,EAAGC,EAAG,iBAAkB,CACnCxB,SAAYA,EACZ,iBAAkBW,EAClB,iBAAkBK,GAAsB,gBAATlB,EAC/B,mBAAoBN,EAAkBC,EAAQC,KAGhD,MAQoB+B,EARhBC,EAAY,GAAGf,EAAY,YAAc,YAAYpB,EAASQ,KA8BlE,GA3BIM,IACFqB,GAAa,IAAIV,EAAY,UAAY,uBAE3CU,GAAa,IAIRrB,GACU,mBAATP,GACS,oBAATA,GACS,gBAATA,KACD6B,kBAAmB9B,GAGpB8B,IACFF,EACEJ,EAAA,QAAA,CACEvB,KAAK,QACLwB,UAAU,mBACVM,QAASjB,EACThB,GAAO,GAAAO,YAAcH,IACrB8B,KAAM,GAAG3B,YACT4B,SAAUH,EACV3B,SAAUA,KAIH,mBAATF,GAA6BL,EAAOsC,eAAgB,CACtD,MAAaC,EAAGC,KAAKC,MAAOzC,EAAOsC,eAAiBzB,EAAkB,MAAQ,EAC9EI,EACEW,EAAA,OAAA,CACEC,UAAU,iBACI,eAAA,GAAGU,aAEhBvC,EAAOsC,iBAuDd,OAjDEtB,EADW,mBAATX,EAEAqC,EAAK,MAAA,CAAAb,UAAU,iBAAgBf,SAAA,CAC7B4B,EAAK,MAAA,CAAAb,UAAWE,EAAG,eAAgB,CAAEY,MAASpB,EAAWqB,KAAQrB,IAC9DT,SAAA,CAAAG,EACDW,EAAM,OAAA,CAAAC,UAAWE,EAAG,SAAU,CAAEY,MAASpB,EAAWqB,KAAQrB,aACzDzB,EAASQ,QAIdoC,EAAK,MAAA,CAAAb,UAAU,gBACbf,SAAA,CAAAc,EAAA,MAAA,CAAKC,UAAU,iBACZf,SAAAA,IAEFC,QAML2B,EAAAG,EAAA,CAAA/B,SAAA,CACY,oBAATT,GAA8BsB,EAC9BV,EACAe,EACDU,EAAA,QAAA,CACElC,WAAYA,EACZsC,QAAY,GAAArC,YAAcH,IAC1BuB,UAAU,eACVf,SAAA,CAAAc,EAAA,OAAA,CAAMC,UAAU,wBACdf,SAAAc,EAAA,SAAA,CACEmB,QAASb,eACGD,EACZJ,UAAU,gBACVtB,SAAUA,GAAYmB,EACR,eAAA,iBAAiB5B,EAASQ,cAEvCR,EAASQ,OAGdoC,SAAKb,UAAU,gBACbf,SAAA,CAAAc,EAAA,MAAA,CAAKC,UAAU,iBACZf,SAAAA,IAEFC,aAQJ,MAAA,CAAAc,UAAU,kBAAiBf,SAC9Bc,aAASoB,KAAK,SAASnB,UAAWC,EAAOhB,SACtCE,OAKTb,EAAO8C,YAAc"}