{"version":3,"file":"index.umd.js","sources":["../src/utils.ts","../src/theme.ts","../src/hooks/useTypesetMath.ts","../src/components/MediaModal.tsx","../src/components/Content.tsx","../src/components/modalManager.tsx","../src/components/Feedback.tsx","../src/components/Answer.tsx","../src/constants.ts","../src/components/AnswersTable.tsx","../src/components/Card.tsx","../src/components/StepCardFooter.tsx","../src/components/Button.tsx","../src/components/CompletionStatus.tsx","../src/components/Question.tsx","../src/components/FreeResponseInput.tsx","../src/components/FreeResponseReview/FreeResponseReview.styles.tsx","../src/components/FreeResponseReview/FreeResponseReview.tsx","../src/components/ExerciseQuestion.tsx","../src/helpers/mathjax.ts","../src/components/ExerciseToolbar.tsx","../src/components/ExerciseHeaderIcons.tsx","../src/components/Exercise/styles.ts","../src/components/Exercise/index.tsx","../src/assets/flag.tsx","../src/components/ProgressBar.tsx","../src/components/Loader.tsx","../src/components/IncludeRemoveQuestion/styles.ts","../src/components/ExercisePreview.tsx","../src/components/IncludeRemoveQuestion/index.tsx"],"sourcesContent":["import { Answer, ID } from '../src/types';\n\nexport const ALPHABET = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\nconst MAX_CORRECTNESS = '1.0';\n\nexport const isAnswerCorrect = function(answer: Answer, correctAnswerId?: ID | null) {\n  // if answer does not have an id, check the isCorrect property.\n  if (!(answer.id || correctAnswerId)) {\n    return answer.isCorrect;\n  }\n  let isCorrect = answer.id === correctAnswerId;\n  if (answer.correctness != null) { isCorrect = (answer.correctness === MAX_CORRECTNESS); }\n\n  return isCorrect;\n};\n\nexport const isAnswerIncorrect = (answer: Answer, incorrectAnswerId?: ID) =>\n  // Allow multiple attempts to show incorrectness without the correct_answer_id\n  answer.id === incorrectAnswerId;\n\nexport const isAnswerChecked = (answer: Answer, answerId?: ID) =>\n   answer.id == answerId;\n\nexport function countWords(text: string) {\n  const trimmedText = text.trim();\n  //https://css-tricks.com/build-word-counter-app/\n  const words = trimmedText.match(/\\b[-?(\\w+)?]+\\b/gi);\n  if(!words) return 0;\n  return words.length;\n}\n\nexport const numberfyId = (id: ID) => typeof id === 'string' ? parseInt(id, 10) : id;\n","import { css } from 'styled-components';\n\nconst palette = {\n  red: \"#ca2026\",\n  danger: \"#c2002f\",\n  darkRed: \"#c22032\",\n  lightRed: \"#e298a0\",\n  green: \"#77af42\",\n  lightGreen: \"#8bc753\",\n  darkGreen: \"#63a524\",\n  paleYellow: \"#ffffbb\",\n  teal: \"#0dc0de\",\n  blue: \"#007da4\",\n  mediumBlue: \"#026AA1\",\n  lightBlue: \"#34bdd8\",\n  neutralLightBlue: \"#0dc0dc\",\n  tangerine: \"#ffbd3e\",\n  gray: \"#5e5e5e\",\n  darkGray: \"#757575\",\n  pale: \"#d5d5d5\",\n  light: \"#e4e4e4\",\n  white: \"#ffffff\",\n  neutralLightest: \"#f9f9f9\", // nearly white\n  neutralCool: \"#f6f7f8\", // cool bright gray\n  neutralBright: \"#f5f5f5\", // bright gray\n  neutralLighter: \"#f1f1f1\", // light gray\n  neutralLight: \"#e5e5e5\", // light gray\n  neutralMedium: \"#a0a0a0\", // light gray\n  neutral: \"#818181\", // gray\n  neutralThin: \"#6f6f6f\", // medium gray\n  neutralDark: \"#5f6163\", // dark gray\n  neutralFeedback: \"#555\", // another dark gray\n  neutralDarker: \"#424242\", // very dark gray\n  black: \"#000000\",\n  orange: \"#D4450C\",\n  yellow: \"#FEDE9F\",\n};\n\nexport const colors = {\n  palette: palette,\n  answer: {\n    neutral: palette.neutralThin,\n    hover: '#026AA1',\n    checked: '#026AA1',\n    correct: '#0D7741',\n    incorrect: '#C22032',\n    partialCredit: '#976502',\n    neutralDark: '#5f6163'\n  },\n  popover: {\n    arrowOuterColor: \"rgba(0, 0, 0, 0.25)\",\n    borderColor: \"rgba(0, 0, 0, 0.2)\",\n  },\n  card: {\n    header: {\n     background: \"#daf3f8\"\n    },\n    body: {\n      background: \"#fdfdfd\"\n    }\n  },\n  button: {\n    background: palette.orange,\n    backgroundHover: \"#E74B0D\",\n    backgroundActive: \"#C5400B\"\n  },\n  freeResponse: {\n    color: palette.neutralDarker,\n    background:palette.neutralLighter,\n  },\n};\n\nexport const layouts = {\n  answer: {\n    verticalSpacing: \"1rem\",\n    horizontalSpacing: \"1rem\",\n    horizontalBuffer: \"2.5rem\",\n    bubbleSize: \"3.6rem\",\n    labelSpacing: \"6.5rem\",\n    feedback: {\n      popover: {\n        horizontalSpacing: \"1.1rem\",\n        verticalSpacing: \"0.9rem\",\n        maxWidth: \"370px\",\n      },\n    },\n  },\n  popover: {\n    arrow: {\n      width: \"16px\",\n      height: \"8px\",\n      edgeDistance: \"9px\",\n    },\n    horizontalSpacing: \"0.8rem\",\n    verticalSpacing: \"1rem\",\n    horizontalBuffer: \"4rem\",\n    borderWidth: \"1px\",\n    maxWidth: \"325px\",\n  },\n  card: {\n    spacing: '2rem'\n  }\n};\n\nexport const BREAKPOINTS = {\n  mobile: 600,\n  tablet: 999,\n  desktop: 1000,\n  large: 1600,\n};\n\nexport const breakpoints = {\n  mobile(...args: Parameters<typeof css>) {\n    return css`@media(max-width: ${BREAKPOINTS.mobile}px) { ${css(...args)} }`;\n  },\n  tablet(...args: Parameters<typeof css>) {\n    return css`@media(max-width: ${BREAKPOINTS.tablet}px) { ${css(...args)} }`;\n  },\n  desktop(...args: Parameters<typeof css>) {\n    return css`@media(min-width: ${BREAKPOINTS.desktop}px) { ${css(...args)} }`;\n  },\n  only: {\n    mobile(...args: Parameters<typeof css>) {\n      return css`@media(max-width: ${BREAKPOINTS.mobile}px) { ${css(...args)} }`;\n    },\n  },\n  margins: {\n    mobile: '8px',\n    tablet: '24px',\n  },\n};\n\nexport const transitions = {\n  answer: \"0.1s ease-in-out\",\n}\n\nexport const mixins = {\n  answer: () => css`\n    .answer-label {\n      display: inline-flex;\n    }\n    color: ${palette.neutralDarker};\n    .answer-letter-wrapper::before {\n      width: ${layouts.answer.bubbleSize};\n      height: ${layouts.answer.bubbleSize};\n      min-width: ${layouts.answer.bubbleSize};\n      min-height: ${layouts.answer.bubbleSize};\n      border-radius: calc(${layouts.answer.bubbleSize} / 2);\n      border-width: 2px;\n      border-style: solid;\n      border-color: #c6c6c6;\n      color: ${colors.answer.neutral};\n      transition: color ${transitions.answer}, border-color ${transitions.answer}, background-color ${transitions.answer};\n      background-color: ${colors.palette.white};\n      font-family: \"Neue Helvetica W01\", Helvetica, Arial, sans-serif;\n      box-sizing: border-box;\n      font-weight: normal;\n    }\n  `,\n  answerColor: (\n    color: string, invertBubble = false\n  ) => css`\n    .answer-letter-wrapper::before {\n      color: ${invertBubble ? '#fff' : color};\n      border-color: ${color};\n      ${invertBubble ? `background-color: ${color};` : null}\n    }\n  `,\n  answerChecked: () => mixins.answerColor(colors.answer.checked, true),\n  answerCorrect: (checked?: boolean) => mixins.answerColor(colors.answer.correct, checked),\n  answerIncorrect: (checked?: boolean) => mixins.answerColor(colors.answer.incorrect, checked),\n  answerHover: () => css`\n    ${mixins.answerColor(colors.answer.hover)};\n    font-weight: bold;\n  `,\n  answerCorrectAnswer: () => mixins.answerColor(colors.answer.correct, false),\n  resetText: () => css`\n    font-family:  \"Neue Helvetica W01\", Helvetica, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Arial, \"Noto Sans\", \"Liberation Sans\", sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji\";\n    font-style: normal;\n    font-weight: 400;\n    line-height: 1.6;\n    text-align: left;\n    text-align: start;\n    text-decoration: none;\n    text-shadow: none;\n    text-transform: none;\n    letter-spacing: normal;\n    word-break: normal;\n    word-spacing: normal;\n    white-space: normal;\n    line-break: auto;\n  `,\n  stepCardPadding: () => css`\n    padding: 4.8rem 14rem 0;\n\n    ${breakpoints.tablet`\n      padding: ${breakpoints.margins.tablet} ${breakpoints.margins.tablet};\n    `}\n\n    ${breakpoints.mobile`\n      padding: calc(${breakpoints.margins.mobile} * 2) ${breakpoints.margins.mobile};\n    `}\n  `,\n  popover: () => css`\n    ${mixins.resetText()}\n\n    z-index: 1;\n    position: relative;\n    border: ${layouts.popover.borderWidth} solid ${colors.popover.borderColor};\n    background-color: ${colors.palette.white};\n    background-clip: padding-box;\n    max-width: ${layouts.popover.maxWidth};\n    margin: calc(${layouts.popover.arrow.height} - 14px) 0 ${layouts.answer.horizontalSpacing} 8px;\n    box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.1);\n    color: ${colors.palette.neutralThin};\n    font-size: calc(1.4rem * var(--content-text-scale));\n\n    .arrow {\n      position: absolute;\n      display: block;\n      width: ${layouts.popover.arrow.width};\n      height: ${layouts.popover.arrow.height};\n      margin-left: ${layouts.popover.arrow.edgeDistance};\n      top: calc(${layouts.popover.arrow.height} * -1);\n\n      &::before,\n      &::after {\n        position: absolute;\n        display: block;\n        content: \"\";\n        border-color: transparent;\n        border-style: solid;\n        border-width: 0 calc(${layouts.popover.arrow.width} / 2) ${layouts.popover.arrow.height} calc(${layouts.popover.arrow.width} / 2);\n      }\n      &::before {\n        top: 0;\n        border-bottom-color: ${colors.popover.borderColor};\n      }\n      &::after {\n        top: ${layouts.popover.borderWidth};\n        border-bottom-color: ${colors.palette.white};\n      }\n    }\n\n    &.right {\n      right: calc(-${layouts.popover.arrow.edgeDistance} - ${layouts.popover.borderWidth});\n      .arrow { right: ${layouts.popover.arrow.edgeDistance}; }\n    }\n\n\n    > .content {\n      padding: ${layouts.popover.verticalSpacing} ${layouts.popover.horizontalSpacing};\n    }\n  `,\n  visuallyHidden: () => css`\n    clip: rect(0 0 0 0);\n    clip-path: inset(50%);\n    height: 1px;\n    overflow: hidden;\n    position: absolute;\n    white-space: nowrap;\n    width: 1px;\n  `\n};\n\nconst theme = {\n  colors: colors,\n  layouts: layouts,\n  transitions: transitions,\n  breakpoints: breakpoints,\n};\n\nexport default theme;\n","import React from \"react\";\n\nexport const TypesetMathContext = React.createContext<() => void>(() => { throw new Error('context not initialized') });\nexport const useTypesetMath = () => React.useContext(TypesetMathContext);\n","import React, { useEffect, useRef } from 'react';\nimport styled from 'styled-components';\n\nconst buttonHeight = 4.2; // rem\nconst buttonMargin = 0.5; // rem\n\n// tslint:disable-next-line:variable-name\nconst Overlay = styled.div`\n  position: fixed;\n  inset: 0;\n  background-color: rgba(0, 0, 0, 0.9);\n  z-index: 1000;\n  display: flex;\n`;\n\n// tslint:disable-next-line:variable-name\nconst ScrollableContent = styled.div`\n  background: white;\n  max-width: 100vw;\n  max-height: calc(100vh - ${(buttonHeight + buttonMargin * 2) * 2}rem);\n  overflow: auto;\n\n  > img {\n    ${/*\n      fix ScrollableContent height issue where it is slightly larger than\n      the image and leaves a gap at the bottom */ ''}\n    display: block;\n  }\n`;\n\n\n// tslint:disable-next-line:variable-name\nconst FloatingCloseButton = styled.button`\n  position: absolute;\n  top: -${buttonHeight + buttonMargin}rem;\n  right: ${buttonMargin}rem;\n  z-index: 10;\n  background: none;\n  border: none;\n  padding: 0;\n  cursor: pointer;\n  width: ${buttonHeight}rem;\n  height: ${buttonHeight}rem;\n`;\n\n// tslint:disable-next-line:variable-name\nconst ContentContainer = styled.div`\n  position: relative;\n  pointer-events: auto;\n`;\n\n// tslint:disable-next-line:variable-name\nconst ModalWrapper = styled.div`\n  position: fixed;\n  inset: 0;\n  overflow: hidden;\n  z-index: 10;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  pointer-events: none;\n`;\n\n\n// tslint:disable-next-line:variable-name\nconst CloseIcon = () => (\n  <svg width='42' height='42' viewBox='0 0 42 42' xmlns='http://www.w3.org/2000/svg'>\n    <rect x='1' y='1' width='40' height='40' rx='20' stroke='white' fill='none' />\n    <line x1='16' y1='16' x2='26' y2='26' stroke='white' strokeWidth='2' strokeLinecap='round' />\n    <line x1='26' y1='16' x2='16' y2='26' stroke='white' strokeWidth='2' strokeLinecap='round' />\n  </svg>\n);\n\ninterface MediaModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n}\n// tslint:disable-next-line:variable-name\nconst MediaModal: React.FC<MediaModalProps> = ({ isOpen, onClose, children }) => {\n  const modalRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (!isOpen || !modalRef.current) return;\n\n    const focusableSelectors = [\n      'button:not([disabled])',\n      '[tabindex]:not([tabindex=\"-1\"])',\n    ].join(', ');\n\n    const focusableElements = modalRef.current.querySelectorAll<HTMLElement>(focusableSelectors);\n    const firstEl = focusableElements[0];\n    const lastEl = focusableElements[focusableElements.length - 1];\n\n    firstEl?.focus();\n\n    const trapFocus = (e: KeyboardEvent) => {\n      if (e.key !== 'Tab') return;\n\n      const activeEl = document.activeElement;\n      const isShift = e.shiftKey;\n\n      if (isShift && activeEl === firstEl) {\n        e.preventDefault();\n        lastEl?.focus();\n      } else if (!isShift && activeEl === lastEl) {\n        e.preventDefault();\n        firstEl?.focus();\n      }\n    };\n\n    document.addEventListener('keydown', trapFocus);\n    return () => {\n      document.removeEventListener('keydown', trapFocus);\n    };\n  }, [isOpen]);\n\n  if (!isOpen) return null;\n\n  return (\n    <Overlay onClick={onClose}>\n      <ModalWrapper aria-modal=\"true\" role=\"dialog\">\n        <ContentContainer\n          ref={modalRef}\n          onClick={(e) => e.stopPropagation()}\n          tabIndex={-1}\n        >\n          <FloatingCloseButton onClick={onClose} aria-label=\"Close media preview\">\n            <CloseIcon />\n          </FloatingCloseButton>\n          <ScrollableContent>{children}</ScrollableContent>\n        </ContentContainer>\n      </ModalWrapper>\n    </Overlay>\n  );\n};\n\nexport default MediaModal;\n","import React, { useEffect, useRef } from \"react\";\nimport { useTypesetMath } from \"../hooks/useTypesetMath\";\nimport { createMediaModalManager } from \"./modalManager\";\n\n/* eslint-disable-next-line @typescript-eslint/no-explicit-any */\ntype ComponentType = keyof JSX.IntrinsicElements | React.JSXElementConstructor<any>;\n\nexport interface ContentProps<T extends ComponentType | undefined> {\n  className?: string;\n  component?: T extends undefined ? undefined :\n    T extends ComponentType ? React.ReactComponentElement<T>:\n    never;\n  html: string;\n  block?: boolean;\n}\n\nfunction enhanceImagesForAccessibility(rootEl: HTMLElement) {\n  rootEl.querySelectorAll('img').forEach((img) => {\n    if (img.closest('button')) {\n      return;\n    }\n\n    const button = document.createElement('button');\n    button.type = 'button';\n    const alt = img.getAttribute('alt');\n    const label = alt ? `Click to enlarge image of ${alt}` : 'Click to enlarge this image';\n    button.setAttribute('aria-label', label);\n\n    button.classList.add('image-button-wrapper');\n\n    img.parentElement?.insertBefore(button, img);\n    button.appendChild(img);\n  });\n}\n\nexport const Content = (<T extends ComponentType | undefined>(\n  { html, component, block = false, ...props }: ContentProps<T>\n) => {\n  const typesetMath = useTypesetMath();\n  const ref = useRef<HTMLDivElement>(null);\n  const DivOrSpan = block ? 'div' : 'span';\n  const mediaModalManager = createMediaModalManager();\n  const MediaModalPortal = mediaModalManager.MediaModalPortal;\n\n  useEffect(() => {\n    const container = ref.current;\n    if (!container) return;\n\n    typesetMath();\n    enhanceImagesForAccessibility(container);\n\n    mediaModalManager.mount(container);\n\n    return () => {\n      mediaModalManager.unmount();\n    };\n  }, [block, mediaModalManager, typesetMath]);\n\n  if (component !== undefined) {\n    return React.cloneElement(component, { html, ...props });\n  }\n\n  return (\n    <>\n      <DivOrSpan ref={ref} dangerouslySetInnerHTML={{ __html: html }} {...props} />\n      <MediaModalPortal />\n    </>\n  );\n});\n","import React, { ReactNode, useEffect } from 'react';\nimport { createPortal } from 'react-dom';\nimport MediaModal from './MediaModal';\n\nfunction createInteractionHandler(open: (content: ReactNode) => void) {\n  return (e: MouseEvent | KeyboardEvent) => {\n    const target = e.target as HTMLElement;\n\n    const button = target.closest('button.image-button-wrapper') as HTMLButtonElement;\n    if (!button) return;\n\n    if (e.type === 'keydown') {\n      const key = (e as KeyboardEvent).key;\n      if (key !== 'Enter' && key !== ' ') return;\n      e.preventDefault();\n    }\n\n    const img = button.querySelector('img') as HTMLImageElement | null;\n    if (!img) return;\n\n    open(\n      <img\n        tabIndex={0}\n        src={img.src}\n        alt={img.alt || ''}\n        width={img.width}\n        height={img.height}\n      />\n    );\n  };\n}\n\nfunction createMediaModalPortal() {\n  let setModalContent: ((content: ReactNode) => void) | null = null;\n\n  const open = (content: ReactNode) => {\n    setModalContent?.(content);\n  };\n\n  const MediaModalPortal: React.FC = () => {\n    const [isOpen, setIsOpen] = React.useState(false);\n    const [modalContent, setContent] = React.useState<ReactNode>(null);\n\n    useEffect(() => {\n      setModalContent = (content) => {\n        setContent(content);\n        setIsOpen(true);\n      };\n      return () => {\n        setModalContent = null;\n      };\n    }, []);\n\n    useEffect(() => {\n      if (!isOpen || typeof document === 'undefined') return;\n      const onKeyDown = (e: KeyboardEvent) => {\n        if (e.key === 'Escape' || e.key === 'Esc') {\n          setIsOpen(false);\n        }\n      };\n\n      const doc = document;\n\n      doc.addEventListener('keydown', onKeyDown);\n      return () => {\n        doc.removeEventListener('keydown', onKeyDown);\n      };\n    }, [isOpen]);\n\n    return createPortal(\n      <MediaModal isOpen={isOpen} onClose={() => setIsOpen(false)}>\n        {modalContent}\n      </MediaModal>,\n      document.body\n    );\n  };\n\n  return { open, MediaModalPortal };\n}\n\nfunction createListeners(open: (content: ReactNode) => void) {\n  let container: HTMLElement | null = null;\n  const handleInteraction = createInteractionHandler(open);\n\n  const attach = () => {\n    if (!container) return;\n    container.addEventListener('click', handleInteraction);\n    container.addEventListener('keydown', handleInteraction);\n  };\n\n  const detach = () => {\n    if (!container ) return;\n    container.removeEventListener('click', handleInteraction);\n    container.removeEventListener('keydown', handleInteraction);\n  };\n\n  const mount = (newContainer: HTMLElement) => {\n    if (container !== newContainer) {\n      detach();\n      container = newContainer;\n    }\n    attach();\n  };\n\n\n  const unmount = () => {\n    detach();\n    container = null;\n  };\n\n  return { mount, unmount };\n}\n\nexport function createMediaModalManager() {\n  const { open, MediaModalPortal } = createMediaModalPortal();\n  const { mount, unmount } = createListeners(open);\n\n  return {\n    open,\n    MediaModalPortal,\n    mount,\n    unmount,\n  };\n}","import classnames from 'classnames';\nimport { Content } from './Content';\n\ninterface FeedbackProps {\n  position?: 'top' | 'bottom' | 'left' | 'right';\n  children: string;\n  className?: string;\n  contentRenderer?: JSX.Element;\n  id: string;\n}\n\nconst SimpleFeedback = (props: Pick<FeedbackProps, 'children' | 'className' | 'contentRenderer'>) => (\n  <aside>\n    <Content\n      component={props.contentRenderer}\n      className={classnames('question-feedback-content', 'has-html', props.className)}\n      html={props.children}\n      block={true} />\n  </aside>\n);\n\nconst Feedback = ({ id, ...props }: FeedbackProps) => {\n  const position = props.position || 'bottom';\n  const wrapperClasses = classnames('question-feedback', position);\n\n  return (\n    <aside id={id} className={wrapperClasses}>\n      <div className=\"arrow\" aria-label=\"Answer Feedback\" />\n      <SimpleFeedback {...props}>\n        {props.children}\n      </SimpleFeedback>\n    </aside>\n  );\n};\n\nexport { Feedback, SimpleFeedback };\n","import cn from 'classnames';\nimport { ReactNode } from 'react';\nimport { ALPHABET, isAnswerChecked, isAnswerCorrect, isAnswerIncorrect } from '../utils';\nimport { Answer as AnswerType, ID } from '../types';\nimport { Content } from './Content';\nimport { SimpleFeedback } from './Feedback';\nimport styled from 'styled-components';\nimport { colors } from '../theme';\n\nconst StyledAnswerIndicator = styled.div<{ state: boolean }>`\n  color: ${props => props.state ? colors.answer.correct : colors.answer.incorrect};\n  text-transform: uppercase;\n  font-size: calc(1.1rem * var(--content-text-scale));\n  font-weight: bold;\n`;\n\n// Annoyingly, sometimes the incorrect answer is only signaled via hasCorrectAnswer and isSelected (not isIncorrect)\nconst AnswerIndicator = (\n  { hasCorrectAnswer, isCorrect, isIncorrect, isSelected }: {\n    hasCorrectAnswer?:boolean; isCorrect?: boolean; isIncorrect?: boolean; isSelected?: boolean\n  }\n) => {\n  if (!isCorrect && !isIncorrect && (!isSelected || !hasCorrectAnswer)) { return null; }\n\n  const text = `${isCorrect ? 'Correct' : 'Incorrect'} Answer`;\n\n  return <StyledAnswerIndicator state={!!isCorrect}>\n    <span>{text}</span>\n  </StyledAnswerIndicator>;\n};\n\nexport interface AnswerProps {\n  answer: AnswerType;\n  iter: number;\n  qid: ID;\n  type: 'teacher-review' | 'teacher-preview' | 'student' | 'student-mpp';\n  hasCorrectAnswer?: boolean;\n  onChangeAnswer?: (answer: AnswerType) => void;\n  disabled: boolean;\n  answerId?: ID;\n  correctAnswerId?: ID | null;\n  incorrectAnswerId?: ID;\n  onKeyPress?: () => void;\n  answered_count?: number;\n  correctIncorrectIcon?: ReactNode,\n  radioBox?: ReactNode;\n  contentRenderer?: JSX.Element;\n  labelAnswers?: boolean;\n  show_all_feedback?: boolean;\n  tableFeedbackEnabled?: boolean;\n  feedbackId?: string;\n}\n\ntype AnswerAnswerProps = Pick<\n  AnswerBodyProps,\n  'answer' |\n  'contentRenderer' |\n  'labelAnswers' |\n  'show_all_feedback' |\n  'tableFeedbackEnabled' |\n  'hasCorrectAnswer' |\n  'isCorrect' |\n  'isIncorrect' |\n  'isSelected'\n>;\n\n// labelAnswers defaults to true, must be explicitly false to disable\nconst AnswerAnswer = (props: AnswerAnswerProps) => {\n  const {\n    answer: { content_html, feedback_html },\n    contentRenderer,\n    labelAnswers,\n    show_all_feedback,\n    tableFeedbackEnabled,\n    hasCorrectAnswer,\n    isCorrect,\n    isIncorrect,\n    isSelected,\n  } = props;\n  return (\n    <div\n      className=\"answer-answer\"\n      role=\"status\"\n      aria-live=\"polite\"\n      aria-atomic=\"true\"\n    >\n      {labelAnswers !== false && <AnswerIndicator hasCorrectAnswer={hasCorrectAnswer} isCorrect={isCorrect}\n                                                  isIncorrect={isIncorrect} isSelected={isSelected} />}\n      <Content className=\"answer-content\" component={contentRenderer} html={content_html} />\n      {show_all_feedback && feedback_html && !tableFeedbackEnabled &&\n        <SimpleFeedback key=\"question-mc-feedback\" contentRenderer={contentRenderer}>\n          {feedback_html}\n        </SimpleFeedback>}\n    </div>\n  )\n}\n\ninterface AnswerBodyProps extends AnswerProps {\n  isCorrect?: boolean;\n  isSelected?: boolean;\n  isIncorrect?: boolean;\n  labelAnswers?: boolean;\n}\n\nconst TeacherReview = (props: AnswerBodyProps) => {\n  const {\n    answer,\n    answered_count,\n    isCorrect,\n    contentRenderer,\n    iter,\n    show_all_feedback,\n    tableFeedbackEnabled,\n  } = props;\n  const percent = answer.selected_count && answered_count\n    ? Math.round((answer.selected_count / answered_count) * 100)\n    : 0;\n  return (\n    <div className=\"review-wrapper\">\n      <div className={cn('review-count', { 'green': isCorrect, 'red': !isCorrect })}>\n        <span\n          className=\"selected-count\"\n          data-percent={`${percent}`}\n        >\n          {answer.selected_count}\n        </span>\n        <span className={cn('letter', { 'green': isCorrect, 'red': !isCorrect })}>\n          {ALPHABET[iter]}\n        </span>\n      </div>\n      <AnswerAnswer\n        answer={answer}\n        contentRenderer={contentRenderer}\n        show_all_feedback={show_all_feedback}\n        tableFeedbackEnabled={tableFeedbackEnabled} />\n    </div>\n  );\n}\n\nconst AnswerChoice = (props: AnswerBodyProps) => {\n  const {\n    type,\n    iter,\n    answer,\n    disabled,\n    onKeyPress,\n    qid,\n    contentRenderer,\n    correctIncorrectIcon,\n    feedbackId,\n    isSelected,\n    isCorrect,\n    isIncorrect,\n    hasCorrectAnswer,\n    show_all_feedback,\n    tableFeedbackEnabled,\n    labelAnswers = true,\n  } = props;\n  const ariaLabel = `${isSelected ? 'Selected ' : ''}Choice ${ALPHABET[iter]}:`;\n  let onChangeAnswer: AnswerProps['onChangeAnswer'];\n\n  const onChange = () => onChangeAnswer && onChangeAnswer(answer);\n\n  if (!hasCorrectAnswer\n    && (type !== 'teacher-review')\n    && (type !== 'teacher-preview')\n    && (type !== 'student-mpp')) {\n    ({ onChangeAnswer } = props);\n  }\n\n  return <>\n    {type === 'teacher-preview' &&\n      <div className=\"correct-incorrect\">\n        {isCorrect && correctIncorrectIcon}\n      </div>}\n    <input\n      type=\"radio\"\n      className=\"answer-input-box\"\n      checked={isSelected}\n      id={`${qid}-option-${iter}`}\n      name={`${qid}-options`}\n      onChange={onChange}\n      disabled={disabled || !onChangeAnswer}\n      aria-details={feedbackId}\n    />\n    <label\n      onKeyPress={onKeyPress}\n      htmlFor={`${qid}-option-${iter}`}\n      className=\"answer-label\">\n      <span\n        className=\"answer-letter-wrapper\"\n        aria-label={ariaLabel}\n        data-answer-choice={ALPHABET[iter]}\n        data-test-id={`answer-choice-${ALPHABET[iter]}`}\n      >\n      </span>\n      <AnswerAnswer\n        answer={answer}\n        contentRenderer={contentRenderer}\n        labelAnswers={labelAnswers}\n        show_all_feedback={show_all_feedback}\n        tableFeedbackEnabled={tableFeedbackEnabled}\n        hasCorrectAnswer={hasCorrectAnswer}\n        isCorrect={isCorrect}\n        isIncorrect={isIncorrect}\n        isSelected={isSelected}\n        />\n    </label>\n  </>\n}\n\nconst AnswerBody = (props: AnswerBodyProps) => {\n  return props.type === 'teacher-review'\n    ? <TeacherReview {...props} />\n    : <AnswerChoice {...props} />\n}\n\nexport const Answer = (props: AnswerProps) => {\n  const {\n    type,\n    answer,\n    disabled,\n    answerId,\n    correctAnswerId,\n    incorrectAnswerId,\n  } = props;\n\n  const isChecked = isAnswerChecked(answer, answerId);\n  const isCorrect = isAnswerCorrect(answer, correctAnswerId);\n  const isIncorrect = isAnswerIncorrect(answer, incorrectAnswerId);\n  // When rendering a previous response, we can determine if it was this answer.\n  // If there is no incorrectAnswerId, that means only a correct answer is present, check isCorrect.\n  // If an incorrectAnswerId is present (there is only ever one, if multiple attempts are enabled,\n  // it is the latest one) checking isIncorrect works because incorrectAnswerId is only set for\n  // a missed attempt, meaning if an attempt is missed and then successfully re-attempted,\n  // incorrectAnswerId will be empty.\n  const isPreviousResponse = answerId === undefined && (!incorrectAnswerId && isCorrect || isIncorrect);\n\n  const isSelected = isChecked || isPreviousResponse;\n  const classes = cn('answers-answer', {\n    'disabled': disabled,\n    'answer-selected': isSelected,\n    'answer-correct': isCorrect && type !== 'student-mpp',\n    'answer-incorrect': incorrectAnswerId && isAnswerIncorrect(answer, incorrectAnswerId),\n  });\n\n  return (\n    <div className=\"openstax-answer\">\n      <section className={classes}>\n        <AnswerBody\n          {...props}\n          isCorrect={isCorrect}\n          isSelected={isSelected}\n          isIncorrect={isIncorrect} />\n      </section>\n    </div>\n  );\n}\nAnswer.displayName = 'OSAnswer';\n","import { AnswerDisplayType } from './types';\n\nexport const defaultAnswerType: AnswerDisplayType = 'student';\n","import { defaultAnswerType } from \"../constants\";\nimport { Answer as AnswerType, AnswerDisplayType, ID, ExerciseQuestionData } from \"src/types\";\nimport { Answer } from \"./Answer\";\nimport { Feedback } from \"./Feedback\";\n\nexport interface AnswersTableProps {\n  question: ExerciseQuestionData;\n  type?: AnswerDisplayType;\n  answer_id?: ID;\n  correct_answer_id?: ID | null;\n  incorrectAnswerId?: ID;\n  answerIdOrder?: ID[],\n  feedback_html: string;\n  correct_answer_feedback_html?: string;\n  answered_count?: number;\n  show_all_feedback?: boolean;\n  labelAnswers?: boolean;\n  tableFeedbackEnabled?: boolean;\n  onChangeAnswer: () => void;\n  hideAnswers: boolean;\n  hasCorrectAnswer?: boolean;\n  onChangeAttempt?: () => void;\n  choicesEnabled?: boolean;\n  onKeyPress?: () => void;\n  contentRenderer?: JSX.Element;\n  instructions?: JSX.Element;\n  previewMode?: boolean;\n}\n\nexport const AnswersTable = (props: AnswersTableProps) => {\n  let idCounter = 0;\n\n  const {\n    question, hideAnswers, type = defaultAnswerType, answered_count, choicesEnabled, correct_answer_id,\n    incorrectAnswerId, answer_id, feedback_html, correct_answer_feedback_html, previewMode,\n    labelAnswers, show_all_feedback = false, tableFeedbackEnabled, hasCorrectAnswer, onChangeAnswer, onKeyPress, answerIdOrder, instructions\n  } = props;\n  if (hideAnswers) { return null; }\n\n  const { id } = question;\n\n  const feedback: { index: number, html: string, id: string }[] = [];\n\n  const sortedAnswersByIdOrder = (idOrder: ID[]) => {\n    const { answers } = question;\n    return answers.slice().sort((a, b) => idOrder.indexOf(a.id) - idOrder.indexOf(b.id));\n  }\n\n  const questionAnswerProps = {\n    qid: id || `auto-${idCounter++}`,\n    answerId: answer_id,\n    correctAnswerId: correct_answer_id,\n    incorrectAnswerId,\n    hasCorrectAnswer,\n    onChangeAnswer: onChangeAnswer,\n    type,\n    answered_count,\n    disabled: previewMode || !choicesEnabled,\n    labelAnswers,\n    show_all_feedback,\n    tableFeedbackEnabled,\n    onKeyPress\n  };\n\n  const answers = answerIdOrder ? sortedAnswersByIdOrder(answerIdOrder) : question.answers;\n\n  const answersHtml = answers.map((answer, i) => {\n    const additionalProps: { answer: AnswerType, iter: number, key: string }\n      = {\n      answer: {\n        ...answer,\n        question_id: typeof question.id === 'string' ? parseInt(question.id, 10) : question.id\n      },\n      iter: i,\n      key: `${questionAnswerProps.qid}-option-${i}`,\n    };\n    const answerProps = Object.assign({}, additionalProps, questionAnswerProps);\n    let html: string | undefined;\n    let feedbackId: string | undefined;\n\n    if (show_all_feedback && answer.feedback_html && tableFeedbackEnabled) {\n      html = answer.feedback_html;\n    } else if (answer.id === incorrectAnswerId && feedback_html) {\n      html = feedback_html;\n    } else if (answer.id === correct_answer_id && correct_answer_feedback_html) {\n      html = correct_answer_feedback_html;\n    }\n\n    if (html) {\n      feedbackId = `feedback-${questionAnswerProps.qid}-${i}`\n      feedback.push({ index: i, html, id: feedbackId });\n    }\n\n    return (\n      <Answer feedbackId={feedbackId} {...answerProps} />\n    );\n  });\n\n  feedback.forEach((item, i) => {\n    const spliceIndex = item.index + i + 1;\n    answersHtml.splice(spliceIndex, 0, (\n      <Feedback id={item.id} key={spliceIndex} contentRenderer={props.contentRenderer}>\n        {item.html}\n      </Feedback>\n    ));\n  });\n\n  return (\n    <div\n      {\n      ...(!previewMode\n        ? {\n          role: \"radiogroup\",\n          'aria-label': \"Answer choices\"\n        }\n        : {})\n      }\n      className=\"answers-table\"\n    >\n      {instructions}\n      {answersHtml}\n    </div>\n  );\n}\n","import { ReactNode, useState, useRef, useEffect, useCallback } from \"react\";\nimport { breakpoints, colors, layouts, mixins } from \"../theme\";\nimport { AvailablePoints, ExerciseScoringData, StepBase, StepWithData } from \"../types\";\nimport styled from \"styled-components\";\nimport cn from \"classnames\";\n\nexport const InnerStepCard = styled.div`\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 auto;\n  margin: 0 auto 5rem auto;\n  border: 0.1rem solid ${colors.palette.pale};\n  border-radius: 0.25rem;\n  background-color: white;\n  overflow: hidden;\n\n  ${breakpoints.desktop`\n    max-width: 1000px;\n  `}\n`;\n\nexport const OuterStepCard = styled.div`\n  padding: ${layouts.card.spacing};\n\n  ${breakpoints.mobile`\n    padding: 0;\n  `}\n`;\n\nconst StepCardHeader = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1.6rem 2.4rem;\n  background: ${colors.card.header.background};\n  font-size: 1.8rem;\n  line-height: 3rem;\n  letter-spacing: -0.72px;\n\n  h2.question-info {\n    display: flex;\n    align-items: baseline;\n    font-size: inherit;\n    margin: inherit;\n    text-transform: uppercase;\n\n    .question-id {\n      font-weight: normal;\n    }\n    .ox-icon-lock {\n        margin-right: 1rem;\n    }\n  }\n\n  .num-questions, .points {\n      display: none;\n  }\n\n  .exercise-id, .separator {\n      font-weight: normal;\n  }\n\n  .separator {\n      margin: 0 0.4rem;\n  }\n\n  .exercise-id {\n      height: 28px; // Fix baseline issue\n  }\n\n  button {\n    color: ${colors.palette.gray};\n  }\n\n  .scoring {\n    margin-left: auto;\n    margin-right: 1rem;\n\n    span {\n      font-size: 1.2rem;\n      font-weight: normal;\n      text-transform: uppercase;\n    }\n  }\n\n  .openstax-exercise-badges {\n      margin: 0;\n      line-height: 2rem;\n      svg {\n          display: block;\n          &:not(.interactive) {\n              margin: 0 0 0 6px !important;\n          }\n      }\n  }\n\n  ${breakpoints.desktop`\n      button.ox-icon-angle-left, button.ox-icon-angle-right {\n          display: none;\n      }\n  `}\n\n    /*\n    1. Show the arrows to move to previous and next question.\n    2. Show the number of questions.\n    3. Override box-shadow of icons when turned into a button.\n    */\n    ${breakpoints.tablet`\n        font-size: 1.6rem;\n        line-height: 2.5rem;\n\n        svg.ox-icon {\n            display: inherit;\n            margin: 0;\n        }\n        button.ox-icon-angle-left {\n            margin-right: ${breakpoints.margins.tablet};\n        }\n        button.ox-icon-angle-right {\n            margin-left: ${breakpoints.margins.tablet};\n        }\n        .openstax-exercise-badges svg {\n            display: none;\n        }\n        .num-questions, points {\n            display: inherit;\n        }\n\n        .exercise-id {\n            display: none;\n        }\n\n        button[class^='ox-icon-angle']:hover {\n            box-shadow: none;\n        }\n  `}\n\n  ${breakpoints.mobile`\n      font-size: 1.6rem;\n      line-height: 2rem;\n      padding: 10px 8px;\n\n      button.ox-icon-angle-left {\n          margin-right: ${breakpoints.margins.mobile};\n      }\n      button.ox-icon-angle-left {\n          margin-right: ${breakpoints.margins.mobile};\n      }\n  `}\n`;\n\nconst StyledUngraded = styled.div`\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  background-color: ${colors.palette.darkRed};\n  border-radius: 0.5rem;\n  width: 7.8rem;\n  height: 1.9rem;\n  padding: 0.2rem 0.4rem;\n\n  span {\n    font-family: \"HelveticaNeue\", \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n    font-weight: bold;\n    line-height: 1.5rem;\n    text-transform: uppercase;\n    color: ${colors.palette.white};\n  }\n`;\n\nStepCardHeader.displayName = 'StepCardHeader';\n\nconst StepCardQuestion = styled.div<{ unpadded?: boolean }>`\n  .step-card-body {\n    ${mixins.stepCardPadding()}\n    overflow: auto;\n    background: ${colors.card.body.background};\n\n    &.exercise-stimulus {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n    }\n  }\n\n    & + div .step-card-body {\n        padding-top: 0;\n    }\n\n    &.exercise-context, &.exercise-stimulus, &.exercise-stem {\n        padding-bottom: 0;\n    }\n\n    ${breakpoints.only.mobile`\n        && .question-feedback {\n            margin-left: 0;\n\n           .arrow { margin-left: 12px; }\n        }\n    `}\n\n    .reading-step & {\n        padding: 0;\n    }\n\n    ${breakpoints.desktop`\n        .video-step &, .interactive-step & {\n            .openstax-exercise-badges {\n              margin-right: 3.8rem;\n            }\n        }\n    `}\n\n    ${breakpoints.mobile`\n        .openstax-exercise-badges svg {\n            margin-right: ${breakpoints.margins.mobile};\n        }\n    `}\n\n    &&& {\n        .openstax-has-html .splash .frame-wrapper { margin-top: 0; }\n    }\n`;\n\nexport const StyledOverlay = styled.div`\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 100%;\n    height: 100%;\n    background-color: #FFFFFF80;\n    z-index: 2;\n`;\n\ninterface SharedProps {\n  questionNumber: number;\n  numberOfQuestions: number;\n  showTotalQuestions: boolean;\n  leftHeaderChildren?: ReactNode;\n  rightHeaderChildren?: ReactNode;\n  headerTitleChildren?: ReactNode;\n}\n\nexport interface StepCardProps extends SharedProps {\n  unpadded: boolean;\n  className?: string;\n  children?: ReactNode;\n  stepType: StepWithData['type'];\n  availablePoints?: AvailablePoints;\n  questionId?: string;\n  multipartBadge?: ReactNode;\n  isHomework: boolean;\n  overlayChildren?: React.ReactNode;\n  totalScoring?: ExerciseScoringData;\n  showScoring?: boolean;\n  isGraded?: boolean;\n}\n\nconst StepCard = ({\n  questionNumber,\n  numberOfQuestions,\n  showTotalQuestions,\n  stepType,\n  isHomework,\n  availablePoints,\n  unpadded, // currently does nothing; may need to restore if this causes tutor stepcard regression\n  className,\n  children,\n  questionId,\n  multipartBadge,\n  leftHeaderChildren,\n  rightHeaderChildren,\n  headerTitleChildren,\n  overlayChildren,\n  showScoring,\n  totalScoring,\n  isGraded,\n  ...otherProps }: StepCardProps) => {\n\n  const overlayRef = useRef<HTMLDivElement>(null);\n  const [showOverlay, setShowOverlay] = useState<boolean>(false);\n\n  const formattedQuestionNumber = numberOfQuestions > 1\n    ? `Questions ${questionNumber} - ${questionNumber + numberOfQuestions - 1}`\n    : `Question ${questionNumber}`;\n\n  const handleOverlayBlur = (event: React.FocusEvent<HTMLDivElement>) => {\n    if (overlayRef.current && !overlayRef.current.contains(event.relatedTarget as Node)) {\n      setShowOverlay(false);\n    }\n  };\n\n  const handleOverlayFocus = useCallback(() => {\n    setShowOverlay(true);\n  }, []);\n\n  const hideFocusableElements = useCallback(() => {\n    const focusableElements = Array.from(document.getElementById(\"step-card\")?.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    ) || []);\n\n    focusableElements.forEach((el) => {\n      (el as HTMLElement).setAttribute('tabindex', '-1');\n    });\n  }, []);\n\n  useEffect(() => {\n    const currentOverlayRef = overlayRef.current;\n    if (currentOverlayRef && overlayChildren) {\n      currentOverlayRef.addEventListener('focus', handleOverlayFocus);\n      hideFocusableElements();\n    }\n    return () => {\n      currentOverlayRef?.removeEventListener('focus', handleOverlayFocus);\n    };\n  }, [overlayChildren, overlayRef, handleOverlayFocus, hideFocusableElements]);\n\n  return (\n    <OuterStepCard {...otherProps}>\n      {multipartBadge}\n      <InnerStepCard className={className}>\n        <div\n          ref={overlayRef}\n          {\n          ...(overlayChildren\n            ? {\n              onMouseOver: () => setShowOverlay(true),\n              onMouseLeave: () => setShowOverlay(false),\n              onBlur: handleOverlayBlur,\n              tabIndex: 0,\n            }\n            : {})\n          }\n        >\n          {(overlayChildren && showOverlay) &&\n            <StyledOverlay id=\"overlay-element\">\n              {overlayChildren}\n            </StyledOverlay>\n          }\n          <div id=\"step-card\">\n            {questionNumber && isHomework && stepType === 'exercise' &&\n              <StepCardHeader className=\"step-card-header\">\n                <div>\n                  {leftHeaderChildren}\n                  <h2 className=\"question-info\">\n                    {headerTitleChildren}\n                    <span>{formattedQuestionNumber}</span>\n                    {showTotalQuestions ? <span className=\"num-questions\">&nbsp;/ {numberOfQuestions}</span> : null}\n                    <span className=\"separator\">|</span>\n                    <span className=\"question-id\">ID: {questionId}</span>\n                  </h2>\n                </div>\n                {showScoring &&\n                  <div className=\"scoring\">\n                    {isGraded \n                      ? <span>{totalScoring?.score?.toFixed(1)}/{totalScoring?.maxScore?.toFixed(1)}{totalScoring?.maxScore && totalScoring.maxScore > 1.1 ? ' points' : ' point'}</span> \n                      : <StyledUngraded><span>ungraded</span></StyledUngraded>\n                  }</div>\n                }\n                {availablePoints || rightHeaderChildren ? <div>\n                  {availablePoints && <div className=\"points\">{availablePoints} Points</div>}\n                  {rightHeaderChildren}\n                </div> : null}\n              </StepCardHeader>\n            }\n            <StepCardQuestion unpadded={unpadded}>{children}</StepCardQuestion>\n          </div>\n        </div>\n      </InnerStepCard>\n    </OuterStepCard>\n  )\n};\nStepCard.displayName = 'OSStepCard';\n\nexport interface TaskStepCardProps extends SharedProps {\n  className?: string;\n  children?: ReactNode;\n  tabIndex?: number;\n  step: StepBase | StepWithData;\n  questionNumber: number;\n  numberOfQuestions: number;\n  overlayChildren?: React.ReactNode;\n  totalScoring?: ExerciseScoringData;\n  showScoring?: boolean;\n  isGraded?: boolean;\n}\n\nconst TaskStepCard = ({\n  step,\n  questionNumber,\n  numberOfQuestions,\n  children,\n  className,\n  overlayChildren,\n  ...otherProps\n}: TaskStepCardProps) =>\n(<StepCard {...otherProps}\n  unpadded={true}\n  questionNumber={questionNumber}\n  numberOfQuestions={numberOfQuestions}\n  stepType={'type' in step ? step.type : 'exercise'}\n  isHomework={'task' in step ? (step.task === undefined || step.task.type === 'homework') : true}\n  data-task-step-id={step.id}\n  // uncomment next line to display available points on exercise questions\n  // availablePoints={step.available_points}\n  className={cn(`${('type' in step ? step.type : 'exercise')}-step`, className)}\n  questionId={step.uid}\n  overlayChildren={overlayChildren}\n>\n  {children}\n</StepCard>);\n\nTaskStepCard.displayName = 'OSTaskStepCard';\n\nexport { StepCard, TaskStepCard };\n","import { colors, breakpoints, mixins } from \"../theme\";\nimport styled from \"styled-components\";\n\nexport const StepCardFooter = styled.div`\n    ${mixins.stepCardPadding()}\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: space-between;\n    font-size: calc(1.6rem * var(--content-text-scale));\n    line-height: calc(2rem * var(--content-text-scale));\n    background: ${colors.card.body.background};\n    overflow: auto;\n\n    > * {\n        flex-grow: 1;\n    }\n\n    button {\n        width: 160px;\n        height: 48px;\n    }\n\n    .step-card-footer-inner {\n        border-top: 1px solid ${colors.palette.pale};\n        padding-top: 32px;\n        display: flex;\n        justify-content: space-between;\n        gap: 1.6rem;\n\n        ${breakpoints.mobile`\n            flex-wrap: wrap;\n        `}\n    }\n\n    .points {\n        .attempts-left {\n          color: #B03808;\n          font-weight: bold;\n        }\n    }\n\n    .controls {\n        display: flex;\n        flex-flow: column wrap-reverse;\n\n        button + button {\n            margin: 0.8rem 0 0 0;\n        }\n    }\n\n    ${breakpoints.desktop`\n        padding: 0 140px 32px 140px;\n        flex-wrap: nowrap;\n\n        .points {\n            max-width: 400px;\n        }\n\n        .controls {\n            flex-flow: row;\n            justify-content: flex-end;\n\n            button + button {\n                margin: 0 0 0 0.8rem;\n            }\n        }\n    `}\n`;\n","import { colors } from \"../theme\";\nimport styled from \"styled-components\";\n\nconst StyledButton = styled.button`\n  background-color: ${colors.button.background};\n  color: ${colors.palette.white};\n  font-size: 1.6rem;\n  font-weight: 700;\n  line-height: 2rem;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  height: 4rem;\n  padding: 0 3rem;\n  border: 0;\n  border-radius: 5px;\n  box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);\n\n  &:not([disabled]) {\n    cursor: pointer;\n    &:hover {\n      background: ${colors.button.backgroundHover}\n    }\n    &:active {\n      background: ${colors.button.backgroundActive}\n    }\n  }\n  &:disabled {\n    opacity: 0.4;\n  }\n`;\n\ninterface ButtonProps extends React.ComponentPropsWithoutRef<'button'> {\n  isWaiting?: never;\n  waitingText?: never;\n}\ninterface WaitingButtonProps extends React.ComponentPropsWithoutRef<'button'> {\n  isWaiting: boolean;\n  waitingText: string;\n}\n\nconst Button = (props: ButtonProps | WaitingButtonProps) => {\n  const { disabled, isWaiting, waitingText, children, ...otherProps } = props;\n\n  return (\n    <StyledButton {...otherProps} disabled={isWaiting || disabled}>{(isWaiting && waitingText) || children}</StyledButton>\n  );\n}\n\nexport default Button;\n","import styled, { createGlobalStyle } from \"styled-components\";\nimport { InnerStepCard } from \"./Card\";\nimport Button from \"./Button\";\nimport { colors } from '../theme';\nconst GlobalStyle = createGlobalStyle`\n  :root {\n    --content-text-scale: 1;\n  }\n`;\n\nexport interface Score {\n  current?: string;\n  saved?: string;\n}\n\nexport interface CompletionStatusProps {\n  numberOfQuestions: number;\n  numberCompleted: number;\n  handleContinue: () => void;\n  handleNext: () => void;\n  className?: string;\n  score?: Score;\n  handleRetry?: () => void;\n  isRetrying?: boolean;\n}\n\nconst CompletionStatusCard = styled(InnerStepCard)`\n  padding: 88px 72px;\n  font-size: calc(1.8rem * var(--content-text-scale));\n  line-height: calc(3rem * var(--content-text-scale));\n  display: block;\n\n  button {\n    height: 48px;\n  }\n\n  p {\n    margin: 16px 0 20px 0;\n  }\n`;\n\nconst CompletionHeader = styled.h2`\n  font-size: calc(2.4rem * var(--content-text-scale));\n  margin: 0;\n`;\n\nconst ButtonGroup = styled.div`\n  display: flex;\n  margin: 0;\n  gap: 1rem;\n\n  button {\n    height: 48px;\n  }\n`;\n\nconst ScoreGroup = styled.div`\n  display: flex;\n  margin: 0;\n  gap: 1rem;\n`;\n\nconst RetryResumeButton = styled(Button)`\n  background-color: ${colors.palette.white};\n  color: ${colors.palette.black};\n  border: 1px solid ${colors.palette.pale};\n  font-weight: normal;\n  transition: background-color 0.2s ease;\n\n  &:hover {\n    background-color: ${colors.palette.neutralBright} !important;\n    color: ${colors.palette.black} !important;\n    border: 1px solid ${colors.palette.pale} !important;\n  }\n\n  &:active {\n    background-color: ${colors.palette.neutralLight} !important;\n    color: ${colors.palette.black} !important;\n    border: 1px solid ${colors.palette.pale} !important;\n  }\n`;\n\nexport const CompletionStatus = styled(({\n  numberOfQuestions,\n  numberCompleted,\n  handleContinue,\n  handleNext,\n  className,\n  score,\n  handleRetry,\n  isRetrying\n}: CompletionStatusProps) => {\n  const allCompleted = numberOfQuestions === numberCompleted;\n  const someCompleted = numberCompleted > 0;\n\n  const buttonText = allCompleted || (numberCompleted === 0 && handleRetry) || (someCompleted && handleRetry) ? 'Next' : (someCompleted ? 'Continue' : 'Start');\n\n  const retryOrResume = allCompleted ? 'Retry Quiz' : 'Resume Quiz';\n  const unlimitedDone = \"Attempts for this quiz are unlimited. Your highest score will be saved.\";\n  const unlimitedCurrent = \"You are in the middle of a quiz attempt. Attempts for this quiz are unlimited. Your highest score will be saved.\";\n\n  // When allCompleted, clicking Retry/Resume should create a new attempt (handleRetry)\n  // When not completed, clicking Retry/Resume should resume (handleContinue)\n  const onRetryResumeClick = allCompleted\n    ? handleRetry\n    : handleContinue;\n\n  // if unlimited attempts (handleRetry) is active always show next button\n  // if all is completed show next button\n  // if not unlimited and incomplete show and handle continue\n  const onNextContinueClick = allCompleted ||  handleRetry\n    ? handleNext\n    : handleContinue;\n\n  return (\n    <>\n      <GlobalStyle />\n      <CompletionStatusCard className={className}>\n        <CompletionHeader>\n          {allCompleted\n            ? 'You are done.'\n            : (someCompleted ? 'Quiz is partially complete.' : 'No questions have been answered.')}\n        </CompletionHeader>\n\n        {handleRetry ? (\n          <div>\n            <p>{allCompleted ? unlimitedDone : unlimitedCurrent}</p>\n            <ScoreGroup>\n              <p>\n                <b>Current Score:</b> {score?.current ?? 'Score unavailable'} | <b>Saved Score:</b> {score?.saved ?? 'Score unavailable'}\n              </p>\n            </ScoreGroup>\n          </div>\n        ) : (\n          <p>\n            {allCompleted\n              ? 'Great job answering all the questions.'\n              : (someCompleted\n                ? `You've completed ${numberCompleted} of ${numberOfQuestions} questions.`\n                : 'Begin working on the quiz.')}\n          </p>\n        )}\n\n        <ButtonGroup>\n          {handleRetry ? (\n            <RetryResumeButton\n              data-test-id=\"retry-resume-btn\"\n              onClick={onRetryResumeClick}\n              disabled={isRetrying}\n            >\n              {retryOrResume}\n            </RetryResumeButton>\n          ) : null}\n\n          <Button\n            data-test-id={`${buttonText.split(' ')[0].toLowerCase()}-btn`}\n            onClick={onNextContinueClick}\n          >\n            {buttonText}\n          </Button>\n        </ButtonGroup>\n      </CompletionStatusCard>\n    </>\n  );\n})``;\n","import styled from 'styled-components';\nimport { mixins, colors, layouts, transitions } from '../theme';\nimport { AnswersTable } from './AnswersTable';\nimport classnames from 'classnames';\nimport { ID, ExerciseQuestionData, Task } from 'src/types';\nimport React, { ReactNode } from 'react';\nimport { Content } from './Content';\n\nconst StyledBodyContainer = styled.div`\n  display: flex;\n  width: 100%;\n  gap: 2rem;\n\n  .step-card-body,\n  .right-side-slot {\n    flex: 1 1 auto;\n    min-width: 0;\n  }\n`;\n\nconst StyledQuestion = styled.div`\n&.step-card-body {\n  ${mixins.stepCardPadding()};\n}\n\n&.openstax-question {\n  border-top: 1px solid ${colors.palette.pale};\n  font-size: calc(1.8rem * var(--content-text-scale));\n\n  .detailed-solution {\n    margin-bottom: 1rem;\n    .header {\n      display: inline;\n      margin-right: 0.5rem;\n      color: #5e6062;\n      font-weight: bold;\n      flex-basis: 0;\n    }\n    .solution {\n      display: inline;\n      color: #6f6f6f;\n    }\n  }\n\n  img {\n    display: block;\n    margin: auto;\n    max-width: 100%;\n  }\n\n  .question-stem {\n    margin-bottom: 0;\n  }\n\n  .answers-table {\n    margin-bottom: 20px;\n    font-size: calc(1.6rem * var(--content-text-scale));\n    line-height: calc(2rem * var(--content-text-scale));\n  }\n\n  .instructions {\n    font-size: 1.4rem;\n    font-style: italic;\n    margin-top: 10px;\n    color: ${colors.palette.neutral};\n    margin: 0;\n\n    i {\n      margin-left: 5px;\n    }\n\n    .text-info {\n      color: ${colors.palette.neutralLightBlue};\n      padding-left: 5px;\n      cursor: pointer;\n      font-style: normal;\n    }\n  }\n\n  .multiple-choice-prompt {\n    font-weight: 600;\n  }\n\n  &:not(.openstax-question-preview) {\n    .answers-answer {\n      width: initial;\n      &:not(.disabled){\n        .answer-label:focus{\n          background-color: ${colors.palette.neutralLightest};\n        }\n      }\n      &.answer-selected {\n        font-weight: bold;\n      }\n      ${mixins.answer()};\n    }\n\n    .answer-answer {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      margin-left: ${layouts.answer.horizontalSpacing};\n      * {\n        margin: 0;\n      }\n    }\n\n    .answer-letter-wrapper::before {\n      content: attr(data-answer-choice);\n      text-align: center;\n      padding: 0;\n      font-size: 1.6rem;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .answer-label {\n      align-items: center;\n      width: 100%;\n      padding: ${layouts.answer.verticalSpacing} 0 0 0;\n      margin: 0;\n      transition: color ${transitions.answer};\n    }\n\n    // a selectable answer\n    .answer-input-box:not([disabled]) ~ .answer-label {\n      cursor: pointer;\n\n      &:hover {\n        ${mixins.answerHover()}\n      }\n    }\n\n    .answer-input-box {\n      ${mixins.visuallyHidden()}\n    }\n\n    // a selected answer\n    &:not(.has-correct-answer) {\n      .answer-input-box {\n        &:checked {\n          + .answer-label,\n          + .answer-label:hover {\n            ${mixins.answerChecked()};\n          }\n        }\n\n        &:focus-visible {\n          + .answer-label .answer-letter-wrapper::before {\n            outline-style: solid;\n            outline-width: 2px;\n            outline-offset: 2px;\n            outline-color: ${colors.answer.checked};\n          }\n        }\n      }\n\n      .answer-selected {\n        .answer-label, .answer-label:hover {\n          ${mixins.answerChecked()};\n        }\n      }\n    }\n\n    // answer that has been checked\n    &.has-correct-answer {\n      .answer-selected {\n        &:not(.answer-correct) {\n          .answer-label {\n            ${mixins.answerIncorrect(true)};\n          }\n        }\n\n        &.answer-correct {\n          .answer-label {\n            ${mixins.answerCorrect(true)};\n          }\n        }\n      }\n\n      .answer-correct:not(.answer-selected) {\n        .answer-label {\n          ${mixins.answerCorrect(false)}\n        }\n      }\n    }\n\n    &.has-incorrect-answer {\n      .answer-incorrect {\n        .answer-label, .answer-label:hover {\n          ${mixins.answerIncorrect()}\n        }\n        &.answer-selected.answer-incorrect {\n          ${mixins.answerIncorrect(true)}\n        }\n      }\n    }\n\n    .question-feedback {\n      ${mixins.popover()}\n      max-width: ${layouts.answer.feedback.popover.maxWidth};\n      .question-feedback-content {\n        padding: ${layouts.answer.feedback.popover.verticalSpacing} ${layouts.answer.feedback.popover.horizontalSpacing};\n      }\n    }\n  }\n\n  .openstax-answer {\n    border-top: 1px solid #d5d5d5;\n    margin: 10px 0;\n    padding: 6px 8px;\n  }\n}\n`;\n\nexport interface QuestionProps {\n  question: ExerciseQuestionData,\n  answer_id?: ID;\n  task?: Task | null,\n  correct_answer_id: ID | null;\n  incorrectAnswerId: ID;\n  hideAnswers: boolean;\n  hidePreambles?: boolean,\n  exercise_uid?: string;\n  displayFormats: boolean,\n  className: string;\n  questionNumber: number;\n  displaySolution: boolean;\n  context?: string;\n  correct_answer_feedback_html?: string;\n  contentRenderer?: JSX.Element;\n  feedback_html: string;\n  onChange: () => void;\n  labelAnswers?: boolean;\n  show_all_feedback?: boolean;\n  tableFeedbackEnabled?: boolean;\n  children?: ReactNode;\n  answerIdOrder?: ID[];\n  choicesEnabled?: boolean;\n  previewMode?: boolean;\n  rightSideSlot?: React.ReactNode;\n}\n\nexport const Question = React.forwardRef((props: QuestionProps, ref: React.ForwardedRef<HTMLDivElement>) => {\n  let exerciseUid, solution;\n\n  const {\n    question, correct_answer_id, incorrectAnswerId, exercise_uid, className, questionNumber,\n    context, task, hidePreambles, rightSideSlot\n  } = props;\n\n  const { stem_html, collaborator_solutions = [], formats, stimulus_html } = question;\n\n  const hasCorrectAnswer = !!correct_answer_id;\n  const hasIncorrectAnswer = !!incorrectAnswerId;\n\n  const taskIsDeleted = (task != null ? task.is_deleted : undefined)\n  const taskIsHomework = ((task != null ? task.type : undefined) === 'homework');\n\n  const classes = classnames('openstax-question', className, {\n    'has-correct-answer': hasCorrectAnswer && !(taskIsDeleted && taskIsHomework),\n    'has-incorrect-answer': hasIncorrectAnswer,\n  });\n\n  const hasSolution = () => {\n    const { displaySolution } = props;\n    const { collaborator_solutions = [] } = question;\n\n    return (\n      displaySolution &&\n      collaborator_solutions &&\n      collaborator_solutions.find(s => s['content_html'] !== undefined)\n    );\n  };\n\n  if (exercise_uid != null) {\n    exerciseUid = (\n      <div className=\"exercise-uid\">\n        {exercise_uid}\n      </div>\n    );\n  }\n\n  if (hasSolution()) {\n    solution =\n      <div className=\"detailed-solution\">\n        <div className=\"header\">\n          Detailed solution:\n        </div>\n        <Content\n          className=\"solution\"\n          block={true}\n          html={collaborator_solutions.map(s => s['content_html']).join('')} />\n      </div>;\n  }\n\n  return (\n    <StyledQuestion ref={ref} className={classes} data-question-number={questionNumber} data-test-id=\"question\">\n      <StyledBodyContainer>\n        <div>\n          <QuestionHtml type=\"context\" html={context} hidden={hidePreambles} />\n          <QuestionHtml type=\"stimulus\" html={stimulus_html} hidden={hidePreambles} />\n          <QuestionHtml type=\"stem\" html={stem_html} hidden={hidePreambles} questionNumber={questionNumber} />\n          {props.children}\n\n          <AnswersTable\n            {...props}\n            onChangeAnswer={props.onChange}\n            hasCorrectAnswer={hasCorrectAnswer}\n          />\n\n          {solution}\n          {props.displayFormats ? <FormatsListing formats={formats} /> : undefined}\n          {exerciseUid}\n        </div>\n        {rightSideSlot && (\n          <div className=\"right-side-slot\">{rightSideSlot}</div>\n        )}\n      </StyledBodyContainer>\n    </StyledQuestion>\n  );\n});\n\ninterface QuestionHtmlProps {\n  html?: string;\n  type: string;\n  hidden: QuestionProps['hidePreambles'];\n  questionNumber?: QuestionProps['questionNumber'];\n}\n\nexport const QuestionHtml = (props: QuestionHtmlProps) => {\n  const { html = '', type, hidden, questionNumber } = props;\n  if (hidden === true || !(html.length > 0)) { return null; }\n\n  return (\n    <Content\n      html={html}\n      data-question-number={questionNumber}\n      className={`question-${type}`}\n      block={true}\n    />\n  );\n};\n\nconst FormatsListing = ({ formats = [] }: { formats: ExerciseQuestionData['formats'] }) => {\n  return (\n    <div className=\"formats-listing\">\n      <div className=\"header\">Formats:</div>\n      {formats.map((format, i) => <span key={i}>{format}</span>)}\n    </div>\n  );\n};\n","import { MouseEventHandler, ReactNode } from 'react';\nimport { countWords } from '../utils';\nimport styled, { css } from 'styled-components';\nimport { colors, mixins } from '../theme';\nimport { AvailablePoints, ExerciseQuestionData } from 'src/types';\nimport { QuestionHtml } from './Question';\nimport Button from './Button';\nimport { StepCardFooter } from './StepCardFooter';\n\nexport interface FreeResponseProps {\n  readOnly: boolean;\n  wordLimit: number;\n  infoRowChildren?: ReactNode;\n  onChange: (event: React.ChangeEvent<HTMLTextAreaElement>) => void;\n  cancelHandler: MouseEventHandler<HTMLButtonElement>;\n  saveHandler: MouseEventHandler<HTMLButtonElement>;\n  defaultValue: string;\n  isSubmitDisabled: boolean;\n  questionNumber: number,\n  question: ExerciseQuestionData,\n  availablePoints?: AvailablePoints,\n  textHasChanged: boolean;\n  submitBtnLabel: string;\n}\n\nconst TextAreaErrorStyle = css`\n  background-color: #f5e9ea;\n`;\n\nconst StyledFreeResponse = styled.div`\n  display: flex;\n  flex-direction: column;\n\n  .step-card-body {\n    ${mixins.stepCardPadding()}\n    padding-bottom: 1rem;\n  }\n`;\n\nconst SyledQuestionStem = styled.div`\n  font-size: 2rem;\n  line-height: 1.68em;\n  position: relative;\n`;\n\nconst InfoRow = styled.div<{ hasChildren: boolean }>`\n  margin: 8px 0;\n  display: flex;\n  justify-content: ${props => props.hasChildren ? 'space-between' : 'flex-end'};\n  line-height: 1.6rem;\n\n  .word-limit-error-info {\n    color: ${colors.palette.danger};\n  }\n\n  div > span {\n    font-size: 12px;\n    line-height: 16px;\n\n    + span {\n      margin-left: 1rem;\n    }\n  }\n\n  .last-submitted + * {\n    margin-top: 0.8rem;\n  }\n\n  color: ${colors.palette.neutralThin};\n`;\n\nexport const FreeResponseTextArea = styled.textarea<{ isOverWordLimit: boolean } & FreeResponseProps>`\n  display: block;\n  font-family: inherit;\n  font-size: 1.8rem;\n  line-height: 3rem;\n  width: 100%;\n  min-height: 10.5em;\n  line-height: 1.5em;\n  margin: 2.5rem 0 0 0;\n  padding: 0.5em;\n  border: 1px solid ${colors.palette.neutral};\n  color: ${colors.palette.neutralDark};\n  ${props => props.isOverWordLimit && TextAreaErrorStyle};\n  ${props => props.isOverWordLimit && css`\n    border: 2px solid ${colors.palette.danger};\n  `}\n  background-color: ${props => props.readOnly && colors.palette.neutralCool};\n`;\nFreeResponseTextArea.displayName = 'OSFreeResponseTextArea';\n\nconst RevertButton = (props: {\n  disabled: boolean\n} & React.ComponentPropsWithoutRef<'button'>) => (\n  <Button {...props}>\n    Cancel\n  </Button>\n);\n\n\nexport const FreeResponseInput = (props: FreeResponseProps) => {\n  const {\n    availablePoints,\n    cancelHandler,\n    defaultValue,\n    infoRowChildren,\n    isSubmitDisabled,\n    question,\n    questionNumber,\n    saveHandler,\n    submitBtnLabel,\n    textHasChanged,\n    wordLimit,\n  } = props;\n\n  const isOverWordLimit = countWords(defaultValue) > wordLimit;\n\n  const questionProps = {};\n  if (questionNumber) { questionProps['data-question-number'] = questionNumber; }\n\n  return (\n    <StyledFreeResponse data-test-id=\"student-free-response\">\n      <div className=\"step-card-body\">\n        <SyledQuestionStem {...questionProps}>\n          {question.stem_html &&\n            <QuestionHtml type=\"stem\" html={question.stem_html} hidden={false} />}\n        </SyledQuestionStem>\n        <FreeResponseTextArea\n          {...props}\n          isOverWordLimit={isOverWordLimit}\n          data-test-id=\"free-response-box\"\n          placeholder=\"Enter your response...\"\n          aria-label=\"question response text box\"\n        />\n        <InfoRow hasChildren={!!infoRowChildren}>\n          {infoRowChildren}\n          <div>\n            <span>{countWords(defaultValue)} words</span>\n            {isOverWordLimit && <span className=\"word-limit-error-info\">Maximum {wordLimit} words</span>}\n          </div>\n        </InfoRow>\n      </div>\n      <StepCardFooter>\n      {availablePoints\n        ? <div className=\"points\" role=\"status\"><strong>Points: {availablePoints}</strong></div>\n        : null}\n        <div className=\"controls\">\n          <RevertButton disabled={!textHasChanged} onClick={cancelHandler} />\n          <Button\n            data-test-id=\"submit-answer-btn\"\n            disabled={isSubmitDisabled || isOverWordLimit}\n            onClick={saveHandler}\n          >\n            {submitBtnLabel}\n          </Button>\n        </div>\n      </StepCardFooter>\n    </StyledFreeResponse>\n  );\n}\n\nFreeResponseInput.displayName = 'OSFreeResponse';\n","import styled from \"styled-components\";\nimport { colors, layouts } from '../../theme';\n\nexport const COLLAPSED_HEIGHT = 16.8; // rem\n\nconst baseContainer = `\n  padding: ${layouts.answer.horizontalSpacing} ${layouts.answer.horizontalBuffer};\n  margin: ${layouts.answer.verticalSpacing} 0 ${layouts.answer.horizontalSpacing} ${layouts.answer.verticalSpacing};\n`;\n\nexport const FreeResponseDefaultContainer = styled.div`\n  ${baseContainer}\n  border-left: ${layouts.answer.horizontalSpacing} solid ${colors.palette.neutralLighter};\n  font-style: italic;\n`;\n\nexport const FreeResponseExpandedContainer = styled.div`\n  ${baseContainer}\n  position: relative;\n  width: 100%;\n`;\n\nexport const FreeResponseText = styled.div<{ expanded: boolean; isOverflowing: boolean;}>`\n  max-height: ${({ expanded }) => (expanded ? \"none\" : `${COLLAPSED_HEIGHT}rem`)};\n  overflow: hidden;\n  position: relative;\n  line-height: 1.6;\n  font-size: 1.4rem;\n\n  ${({ expanded, isOverflowing }) =>\n    !expanded && isOverflowing\n      ? `\n    display: -webkit-box;\n    -webkit-line-clamp: 6;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  `\n      : \"\"}\n`;\n\nexport const ReadMoreLink = styled.button`\n  display: inline;\n  background: none;\n  border: none;\n  color: ${colors.palette.blue};\n  padding: 0;\n  margin: 0;\n  cursor: pointer;\n  font-size: 1.3rem;\n  text-decoration: underline;\n  white-space: nowrap;\n`;\n  \n  ","import React from \"react\";\nimport { \n  FreeResponseDefaultContainer, \n  FreeResponseExpandedContainer, \n  FreeResponseText, \n  ReadMoreLink, \n  COLLAPSED_HEIGHT \n} from \"./FreeResponseReview.styles\";\n\nconst FreeResponseContainer = (\n  { children, previewMode }: { children: React.ReactNode, previewMode: boolean | undefined }\n) => {\n    return (\n      previewMode \n        ? <FreeResponseExpandedContainer>{children}</FreeResponseExpandedContainer>\n        : <FreeResponseDefaultContainer>{children}</FreeResponseDefaultContainer>\n    );\n  };\n\nexport const FreeResponseReview = ({ free_response, previewMode }: {\n  free_response?: string;\n  previewMode?: boolean;\n}) => {\n\n  const [expanded, setExpanded] = React.useState(false);\n  const [isOverflowing, setIsOverflowing] = React.useState(false);\n  const textRef = React.useRef<HTMLDivElement>(null);\n\n  React.useLayoutEffect(() => {\n    if (previewMode && textRef.current) {\n      const isTextOverflowing =\n        !expanded && textRef.current.scrollHeight > COLLAPSED_HEIGHT * 10; // px\n      setIsOverflowing(isTextOverflowing);\n    }\n  }, [free_response, previewMode, expanded]);\n\n\n  if (!free_response) { return null; }\n\n  return (\n    <FreeResponseContainer previewMode={previewMode}>\n      {previewMode \n        ? <FreeResponseText\n            ref={textRef}\n            expanded={expanded}\n            isOverflowing={isOverflowing}\n          >\n            {free_response}\n          </FreeResponseText>\n        : free_response\n      }\n      {previewMode && (isOverflowing || expanded) && (\n        <ReadMoreLink onClick={() => setExpanded(!expanded)}>\n          {expanded ? \"show less\" : \"read more\"}\n        </ReadMoreLink>\n      )}\n    </FreeResponseContainer>\n  );\n}","import React from \"react\";\nimport { numberfyId } from \"../../src/utils\";\nimport { AvailablePoints, ID, ExerciseQuestionData, Task } from \"../types\";\nimport Button from \"./Button\";\nimport { Content } from \"./Content\";\nimport { ExerciseBaseProps } from \"./Exercise\";\nimport { Question } from './Question';\nimport { StepCardFooter } from \"./StepCardFooter\";\nimport { FreeResponseReview } from \"./FreeResponseReview/FreeResponseReview\";\n\nexport interface ExerciseQuestionProps {\n  task?: Task;\n  question: ExerciseQuestionData;\n  answer_id_order?: ID[];\n  questionNumber: number;\n  choicesEnabled: boolean;\n  hasMultipleAttempts: boolean;\n  hasUnlimitedAttempts: boolean;\n  onAnswerChange: () => void;\n  onAnswerSave: ExerciseBaseProps['onAnswerSave'];\n  onNextStep: ExerciseBaseProps['onNextStep'];\n  feedback_html: string;\n  correct_answer_feedback_html: string;\n  is_completed: boolean;\n  correct_answer_id: ID;\n  incorrectAnswerId: ID;\n  answer_id?: ID;\n  attempts_remaining: number;\n  published_comments?: string;\n  detailedSolution?: string;\n  canAnswer: boolean;\n  needsSaved: boolean;\n  canUpdateCurrentStep: boolean;\n  attempt_number: number;\n  apiIsPending: boolean;\n  displaySolution: boolean;\n  available_points?: AvailablePoints;\n  exercise_uid: string;\n  free_response?: string;\n  labelAnswers?: boolean;\n  show_all_feedback?: boolean;\n  tableFeedbackEnabled?: boolean;\n  hasFeedback?: ExerciseBaseProps['hasFeedback'];\n  previewMode?: boolean;\n  rightSideSlot?: React.ReactNode;\n}\n\nconst AttemptsRemaining = ({ count }: { count: number }) => {\n  return (\n    <div>{count} attempt{count === 1 ? '' : 's'} left</div>\n  );\n}\n\nconst UnlimitedAttempts = () => {\n  return (\n    <div>Unlimited quiz attempts left</div>\n  );\n}\n\nconst PublishedComments = ({ published_comments }: { published_comments?: string }) => {\n  if (!published_comments) { return null; }\n\n  return (\n    <div>\n      <strong>Feedback:</strong> {published_comments}\n    </div>\n  );\n}\n\nexport const SaveButton = (props: {\n  disabled: boolean, isWaiting: boolean, attempt_number: number, willContinue: boolean\n} & React.ComponentPropsWithoutRef<'button'>) => (\n  <Button\n    {...props}\n    waitingText=\"Saving\"\n    isWaiting={props.isWaiting}\n    data-test-id=\"submit-answer-btn\"\n  >\n    {props.willContinue\n      ? 'Submit & continue'\n      : (props.attempt_number == 0 ? 'Submit' : 'Re-submit')}\n  </Button>\n);\n\nexport const NextButton = (props: {\n  canUpdateCurrentStep: boolean,\n} & React.ComponentPropsWithoutRef<'button'>) => {\n  return (\n    <Button {...props} data-test-id=\"continue-btn\">\n      {props.canUpdateCurrentStep ? 'Continue' : 'Next'}\n    </Button>\n  );\n}\n\nexport const ExerciseQuestion = React.forwardRef((props: ExerciseQuestionProps, ref: React.ForwardedRef<HTMLDivElement>) => {\n  const {\n    question, task, answer_id_order, onAnswerChange, feedback_html, correct_answer_feedback_html,\n    is_completed, correct_answer_id, incorrectAnswerId, choicesEnabled, questionNumber,\n    answer_id, hasMultipleAttempts, hasUnlimitedAttempts, attempts_remaining, published_comments, detailedSolution,\n    canAnswer, needsSaved, attempt_number, apiIsPending, onAnswerSave, onNextStep, canUpdateCurrentStep,\n    displaySolution, available_points, free_response, labelAnswers, show_all_feedback, tableFeedbackEnabled,\n    hasFeedback, previewMode\n  } = props;\n\n  const [shouldContinue, setShouldContinue] = React.useState(false)\n  React.useEffect(() => {\n    if (shouldContinue && is_completed) {\n      onNextStep(questionNumber - 1);\n      setShouldContinue(false);\n    }\n  }, [onNextStep, questionNumber, shouldContinue, is_completed]);\n\n  return (\n    <div data-test-id=\"student-exercise-question\">\n      <Question\n        ref={ref}\n        task={task}\n        question={question}\n        answerIdOrder={answer_id_order}\n        choicesEnabled={choicesEnabled}\n        answer_id={answer_id}\n        questionNumber={questionNumber}\n        onChange={onAnswerChange}\n        feedback_html={feedback_html}\n        correct_answer_feedback_html={correct_answer_feedback_html}\n        correct_answer_id={is_completed ? correct_answer_id : null}\n        incorrectAnswerId={incorrectAnswerId}\n        className=\"step-card-body\"\n        hideAnswers={false}\n        displayFormats={false}\n        displaySolution={displaySolution}\n        labelAnswers={labelAnswers}\n        show_all_feedback={show_all_feedback}\n        tableFeedbackEnabled={tableFeedbackEnabled}\n        previewMode={previewMode}\n        rightSideSlot={props.rightSideSlot}\n      >\n        <FreeResponseReview free_response={free_response} previewMode={previewMode} />\n      </Question>\n      {(previewMode && detailedSolution) || !previewMode ?\n        <StepCardFooter className=\"step-card-footer\">\n          <div className=\"step-card-footer-inner\">\n            <div className=\"points\" role=\"status\" >\n              {available_points ? <strong>Points: {available_points}</strong> : null}\n              <span className=\"attempts-left\">\n                {hasMultipleAttempts &&\n                  attempts_remaining > 0 &&\n                  <AttemptsRemaining count={attempts_remaining} />}\n                  { hasUnlimitedAttempts ? <UnlimitedAttempts/>: null}\n\n              </span>\n              \n              <PublishedComments published_comments={published_comments} />\n              {detailedSolution && (<div><strong>Detailed solution:</strong> <Content html={detailedSolution} /></div>)}\n            </div>\n            <div className=\"controls\">\n              {(canAnswer && needsSaved) || shouldContinue ?\n                <SaveButton\n                  disabled={apiIsPending || !answer_id || shouldContinue}\n                  isWaiting={apiIsPending || shouldContinue}\n                  attempt_number={attempt_number}\n                  onClick={() => {\n                    onAnswerSave(numberfyId(question.id));\n                    if (!hasFeedback) {\n                      setShouldContinue(true);\n                    }\n                  }}\n                  willContinue={!hasFeedback}\n                /> :\n                <NextButton onClick={() => onNextStep(questionNumber - 1)} canUpdateCurrentStep={canUpdateCurrentStep} />}\n            </div>\n          </div>\n        </StepCardFooter> : null}\n    </div>\n  );\n})\n","import { debounce, once } from 'lodash';\nimport { isEmpty, memoize } from 'lodash/fp.js';\nimport WeakMap from 'weak-map';\n\ndeclare global {\n  interface Window {\n    MathJax?: any;\n    __debugMathJax?: boolean;\n  }\n}\n\nconst MATH_MARKER_BLOCK  = '\\u200c\\u200c\\u200c'; // zero-width non-joiner\nconst MATH_MARKER_INLINE = '\\u200b\\u200b\\u200b'; // zero-width space\n\nconst MATH_RENDERED_CLASS = 'math-rendered';\nconst MATH_MARKED_CLASS = 'math-marked';\nconst MATH_DATA_SELECTOR = `[data-math]:not(.${MATH_RENDERED_CLASS})`;\nconst MATH_ML_SELECTOR   = `math:not(.${MATH_RENDERED_CLASS})`;\nconst COMBINED_MATH_SELECTOR = `${MATH_DATA_SELECTOR}, ${MATH_ML_SELECTOR}`;\nconst MATHJAX_CONFIG = {\n  extensions: [],\n  showProcessingMessages: false,\n  skipStartupTypeset: true,\n  styles: {\n    '#MathJax_MSIE_Frame': {\n      left: '', right: 0, visibility: 'hidden',\n    },\n    '#MathJax_Message': {\n      left: '', right: 0, visibility: 'hidden',\n    },\n  },\n  tex2jax: {\n    displayMath: [[MATH_MARKER_BLOCK, MATH_MARKER_BLOCK]],\n    inlineMath:  [[MATH_MARKER_INLINE, MATH_MARKER_INLINE]],\n  },\n};\n\nconst findProcessedMath = (root: Element): Element[] => Array.from(root.querySelectorAll('.MathJax math'));\nconst findUnprocessedMath = (root: Element): Element[] => {\n  const processedMath = findProcessedMath(root);\n  return Array.from(root.querySelectorAll('math')).filter((node) => processedMath.indexOf(node) === -1);;\n};\n\nconst findLatexNodes = (root: Element): Element[] => {\n  const latexNodes: Element[] = [];\n  for (const node of Array.from(root.querySelectorAll(MATH_DATA_SELECTOR))) {\n    const formula = node.getAttribute('data-math');\n\n    // Set textContent once so that resolveOrWait calls don't\n    // undo a MathJax pass before rendered class is applied\n    if (!node.classList.contains(MATH_MARKED_CLASS)) {\n      node.textContent = (node.tagName.toLowerCase() === 'div')\n        ? `${MATH_MARKER_BLOCK}${formula}${MATH_MARKER_BLOCK}`\n        : `${MATH_MARKER_INLINE}${formula}${MATH_MARKER_INLINE}`;\n      node.classList.add(MATH_MARKED_CLASS);\n    }\n    latexNodes.push(node);\n  }\n\n  return latexNodes;\n};\n\nconst typesetLatexNodes = (latexNodes: Element[], windowImpl: Window) => () => {\n  if (isEmpty(latexNodes)) {\n    return;\n  }\n\n  windowImpl.MathJax.Hub.Queue(\n    () => windowImpl.MathJax.Hub.Typeset(latexNodes),\n    markLatexNodesRendered(latexNodes)\n  );\n};\n\nconst typesetMathMLNodes = (root: Element, windowImpl: Window) => () => {\n  const mathMLNodes = findUnprocessedMath(root);\n\n  if (isEmpty(mathMLNodes)) {\n    return;\n  }\n\n  // style the entire document because mathjax is unable to style individual math elements\n  windowImpl.MathJax.Hub.Queue(\n    () => windowImpl.MathJax.Hub.Typeset(root)\n  );\n};\n\nconst markLatexNodesRendered = (latexNodes: Element[]) => () => {\n  // Queue a call to mark the found nodes as rendered so are ignored if typesetting is called repeatedly\n  // uses className += instead of classList because IE\n  const result = [];\n  for (const node of latexNodes) {\n    result.push(node.className += ` ${MATH_RENDERED_CLASS}`);\n  }\n};\n\n// Search document for math and [data-math] elements and then typeset them\nfunction typesetDocument(root: Element, windowImpl: Window) {\n  const latexNodes = findLatexNodes(root);\n\n  windowImpl.MathJax.Hub.Queue(\n    typesetLatexNodes(latexNodes, windowImpl),\n    typesetMathMLNodes(root, windowImpl)\n  );\n}\n\nconst resolveOrWait = (root: Element, resolve: () => void, remainingTries = 5) => {\n  if (\n    remainingTries > 0\n    && (findLatexNodes(root).length || findUnprocessedMath(root).length)\n  ) {\n    setTimeout(() => {\n      resolveOrWait(root, resolve, remainingTries - 1);\n    }, 200);\n  } else {\n    resolve();\n  }\n};\n\nconst typesetDocumentPromise = (root: Element, windowImpl: Window): Promise<void> => new Promise((resolve) => {\n  typesetDocument(root, windowImpl);\n  windowImpl.MathJax.Hub.Queue(() => {\n    resolveOrWait(root, resolve);\n  });\n});\n\n// memoize'd getter for typeset document function so that each node's\n// typeset has its own debounce\nconst getTypesetDocument = memoize((root, windowImpl) => {\n  // Install a debounce around typesetting function so that it will only run once\n  // every Xms even if called multiple times in that period\n  return debounce(typesetDocumentPromise, 100, {\n    leading: true,\n    trailing: false,\n  }).bind(null, root, windowImpl);\n});\ngetTypesetDocument.cache = new WeakMap();\n\n// typesetMath is the main exported function.\n// It's called by components like HTML after they're rendered\nconst typesetMath = async (root: Element, windowImpl = window) => {\n  await startMathJax();\n\n  // check if MathJax is setup\n  if (!(windowImpl && windowImpl.MathJax && windowImpl.MathJax.Hub)) {\n    console.warn('Warning: Expected MathJax to be initialized.');\n    return Promise.resolve();\n  }\n\n  // schedule a Mathjax pass if there is at least one [data-math] or <math> element present\n  if (root.querySelector(COMBINED_MATH_SELECTOR)) {\n    return getTypesetDocument(root, windowImpl)();\n  }\n\n  return Promise.resolve();\n};\n\nconst startMathJax: (windowImpl?: Window) => Promise<void> = once((windowImpl: Window = window) => new Promise((resolve) => {\n  const configuredCallback = () => {\n    // there doesn't seem to be a config option for this\n    windowImpl.MathJax.HTML.Cookie.prefix = 'mathjax';\n    // proceed with mathjax initi\n    windowImpl.MathJax.Hub.Configured();\n    windowImpl.MathJax.Hub.Register.StartupHook('End', () => {\n      resolve();\n    });\n  };\n\n  if (!document.getElementById('MathJax-Script')) {\n    const script = document.createElement('script');\n    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML-full&delayStartupUntil=configured';\n    script.id = 'MathJax-Script';\n    script.async = true;\n    document.head.appendChild(script);\n  }\n\n  if (windowImpl.MathJax && windowImpl.MathJax.Hub) {\n    windowImpl.MathJax.Hub.Config(MATHJAX_CONFIG);\n    // Does not seem to work when passed to Config\n    windowImpl.MathJax.Hub.processSectionDelay = 0;\n    configuredCallback();\n  } else {\n    // If the MathJax.js file has not loaded yet:\n    // Call MathJax.Configured once MathJax loads and\n    // loads this config JSON since the CDN URL\n    // says to `delayStartupUntil=configured`\n    (MATHJAX_CONFIG as any).AuthorInit = configuredCallback;\n    windowImpl.MathJax = MATHJAX_CONFIG;\n  }\n}));\n\nexport {\n  typesetMath,\n  startMathJax,\n};\n","import { colors, layouts, breakpoints } from \"../../src/theme\";\nimport styled, { css } from \"styled-components\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faBookOpen, faTriangleExclamation } from \"@fortawesome/free-solid-svg-icons\";\nimport { ExerciseIcons } from \"./Exercise\";\n\nexport const StyledToolbar = styled.div<{\n  mobile: boolean;\n  desktop: boolean;\n}>`\n  position: absolute;\n  background: #fff;\n  width: 4.5rem;\n  border: 1px solid ${colors.palette.light};\n  background: #fff;\n  margin: ${layouts.card.spacing} 0 0 ${layouts.card.spacing};\n  z-index: 1;\n\n  > * {\n    height: 4.7rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: ${colors.palette.neutral};\n    background: #fff;\n    text-decoration: none;\n\n    &:after {\n      border-bottom: 1px solid #f1f1f1;\n    }\n\n    svg {\n      width: 4.3rem;\n      height: 1.6rem;\n      transition: color 150ms;\n    }\n\n    span {\n      display: none;\n      flex-grow: 1;\n      font-size: 1.4rem;\n      color: ${colors.palette.neutralDarker};\n    }\n\n    &:hover {\n      box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 2px;\n      width: 20rem;\n\n      svg {\n        color: ${colors.palette.neutralDarker};\n      }\n\n      span {\n        display: block;\n      }\n    }\n  }\n\n  ${props => !props.desktop && css`\n    ${breakpoints.desktop`\n      display: none;\n    `}\n    ${breakpoints.tablet`\n      display: none;\n    `}\n  `}\n\n  ${props => props.mobile && breakpoints.mobile`\n    display: block;\n    position: relative;\n    width: auto;\n    display: flex;\n    flex-direction: row;\n    margin: 0;\n\n    &:not(:last-child) {\n      border-bottom: 0;\n    }\n\n    > * {\n      flex-direction: column;\n      flex-grow: 1;\n      align-items: center;\n      justify-content: center;\n      padding: 1rem 1.8rem 0.6rem;\n      height: auto;\n      min-height: 4.8rem;\n\n      &:hover {\n        width: auto;\n      }\n\n      span {\n        display: block;\n        font-size: 1.4rem;\n        margin-top: 0.2rem;\n        color: ${colors.palette.neutral};\n        text-align: center;\n      }\n\n      & + * {\n        border-left: 1px solid ${colors.palette.light};\n      }\n    }\n  `}\n`;\n\nexport const ExerciseToolbar = ({ icons }: { icons?: ExerciseIcons }) => {\n  if (!icons) {\n    return null;\n  }\n  const settings = Object.values(icons);\n  const mobile = settings.some(({ location }) => location?.toolbar?.mobile ?? true);\n  const desktop = settings.some(({ location }) => location?.toolbar?.desktop ?? false);\n  const topicUrl = icons.topic?.url;\n  const errataUrl = icons.errata?.url;\n\n  return <StyledToolbar {...{ mobile, desktop }}>\n    {topicUrl ? <a href={topicUrl} target=\"_blank\">\n      <FontAwesomeIcon icon={faBookOpen}></FontAwesomeIcon>\n      <span>View topic in textbook</span>\n    </a> : null}\n    {errataUrl ? <a href={errataUrl} target=\"_blank\">\n      <FontAwesomeIcon icon={faTriangleExclamation}></FontAwesomeIcon>\n      <span>Suggest a correction</span>\n    </a> : null}\n  </StyledToolbar>\n};\n","import styled, { css } from 'styled-components';\nimport { breakpoints, colors, mixins } from '../../src/theme';\nimport { ExerciseData } from '../../src/types';\nimport { faBookOpen } from '@fortawesome/free-solid-svg-icons/faBookOpen';\nimport { faTriangleExclamation } from '@fortawesome/free-solid-svg-icons/faTriangleExclamation';\nimport { faCircleInfo } from '@fortawesome/free-solid-svg-icons/faCircleInfo';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { ExerciseIcons } from './Exercise';\n\ntype ExplanationType = 'multiple-choice' | 'two-step';\n\nconst TypeExplanations: { [key in ExplanationType]: string } = {\n  'multiple-choice': 'Select the best answer from the given list of distractors. Your instructor may or may not allow multiple attempts.',\n  'two-step': 'In a two-step question, OpenStax asks for your own answer first, then gives multiple-choice options to help you assess your learnings. \\\nRecalling the answer to a question from memory helps you to retain things longer.',\n}\n\nconst ItemWrapper = styled.div<{ mobile: boolean; desktop: boolean }>`\n  padding: 0.6rem 0.9rem;\n  .popover { display: none; }\n  &:hover {\n    svg path { fill: ${colors.palette.mediumBlue};}\n    .popover { display: flex; }\n  }\n  ${props => !props.desktop && css`\n    ${breakpoints.desktop`\n      display: none;\n    `}\n    ${breakpoints.tablet`\n      display: none;\n    `}\n  `}\n  ${props => !props.mobile && breakpoints.mobile`\n    display: none;\n  `}\n`;\n\nconst InnerWrapper = styled.div`\n  position: relative;\n  display: flex;\n`;\n\nconst Popover = styled.div`\n  ${mixins.popover}\n  top: 3rem;\n  width: 20rem;\n  position: absolute;\n  font-size: 1.4rem;\n  line-height: 1.8rem;\n`;\n\ninterface PopoverItemProps {\n  text: string;\n  children: JSX.Element;\n  wrapperProps?: {\n    as: keyof JSX.IntrinsicElements;\n    href?: string;\n    target?: string;\n  },\n  mobile: boolean;\n  desktop: boolean;\n}\n\nconst PopoverItem = (props: PopoverItemProps) => (\n  <ItemWrapper\n    {...props.wrapperProps}\n    mobile={props.mobile}\n    desktop={props.desktop}\n    aria-label={props.text}\n  >\n    <InnerWrapper>\n      {props.children}\n      <Popover className=\"popover right\">\n        <div className=\"arrow\"></div>\n        <div className=\"content\">{props.text}</div>\n      </Popover>\n    </InnerWrapper>\n  </ItemWrapper>\n);\n\nconst PopoverItemsWrapper = styled.div`\n  max-width: 200px;\n  display: flex;\n  justify-content: space-between;\n`;\n\nconst StyledFontAwesomeIcon = styled(FontAwesomeIcon)`\n  color: ${colors.palette.darkGray};\n  height: 1em;\n`;\n\nexport const ExerciseHeaderIcons = ({ exercise, icons }: {\n  exercise: ExerciseData, icons: ExerciseIcons\n}) => {\n  const defaultHeaderLocation = { desktop: true, mobile: false };\n  const items = [];\n  const isMultipleChoice = exercise.questions.every((q) => q.answers.length > 0);\n  let typeExplanation;\n\n  if (isMultipleChoice && exercise.questions.find((q) => q.formats.includes('free-response'))) {\n    typeExplanation = TypeExplanations['two-step'];\n  } else if (isMultipleChoice) {\n    typeExplanation = TypeExplanations['multiple-choice'];\n  }\n\n  if (icons.topic) {\n    items.push(\n      <PopoverItem\n        key='topic'\n        text='View topic in textbook'\n        wrapperProps={{ as: 'a', href: icons.topic.url, target: '_blank' }}\n        {...icons.topic.location?.header || defaultHeaderLocation}\n      >\n        <StyledFontAwesomeIcon icon={faBookOpen}></StyledFontAwesomeIcon>\n      </PopoverItem>\n    );\n  }\n\n  if (icons.errata) {\n    items.push(\n      <PopoverItem\n        key='errata'\n        text='Suggest a correction'\n        wrapperProps={{ as: 'a', href: icons.errata.url, target: '_blank' }}\n        {...icons.errata.location?.header || defaultHeaderLocation}\n      >\n        <StyledFontAwesomeIcon icon={faTriangleExclamation}></StyledFontAwesomeIcon>\n      </PopoverItem>\n    )\n  }\n\n  if (icons.info && typeExplanation) {\n    items.push(\n      <PopoverItem\n        key='type'\n        text={typeExplanation}\n        {...icons.info.location?.header || defaultHeaderLocation}\n      >\n        <StyledFontAwesomeIcon icon={faCircleInfo} height='16px' width='16px'></StyledFontAwesomeIcon>\n      </PopoverItem>\n    )\n  }\n\n  return (\n    <PopoverItemsWrapper>\n      {items}\n    </PopoverItemsWrapper>\n  );\n};\n","import { colors } from \"../../theme\";\nimport { css } from \"styled-components\";\n\nexport const exerciseStyles = css`\n  .image-button-wrapper {\n    /* Remove default button styles for media modal img wrapper */\n    border: none;\n    padding: 0;\n    margin: 0;\n    background: none;\n    display: inline-block;\n    cursor: pointer;\n  }\n\n  .image-button-wrapper:focus {\n    outline: 1px solid Highlight;\n    outline: 1px solid -webkit-focus-ring-color;\n    outline-offset: 2px;\n  }\n\n  .image-button-wrapper img {\n    display: block;\n    max-width: 100%;\n    height: auto;\n  }\n  &.is-selected {\n    background-color: ${colors.card.header.background};\n    border-width: 0.2rem;\n\n    .step-card-footer,\n    .step-card-body,\n    .step-card-header {\n      background-color: ${colors.card.header.background} !important;\n    }\n\n    .openstax-question {\n      border-width: 0.2rem !important;\n    }\n  }\n\n  &.preview-card {\n    --spacing: 0.8rem;\n    margin: 0 auto auto auto !important;\n\n    [data-task-step-id] {\n      padding: 0;\n    }\n\n    .step-card-header,\n    .step-card-body {\n      background-color: ${colors.palette.white};\n      padding: var(--spacing);\n      font-size: 1.6rem;\n      line-height: 2rem;\n    }\n\n    .step-card-footer {\n      padding: 0 var(--spacing) var(--spacing);\n    }\n\n    .step-card-footer-inner {\n      padding-top: var(--spacing);\n    }\n\n    .answers-table {\n      margin: 0;\n    }\n\n    .exercise-context {\n      .os-title {\n        margin: 0 0 var(--spacing);\n      }\n      .os-subtitle {\n        margin: var(--spacing) 0;\n      }\n      figure {\n        float: left;\n        margin: 0;\n      }\n      img {\n        max-width: 16rem;\n      }\n      p:last-child {\n        margin-bottom: 0;\n      }\n    }\n    .openstax-question {\n      .openstax-answer {\n        padding: 0;\n        border: none;\n\n        .answer-label {\n          padding-top: var(--spacing);\n        }\n\n        .answer-letter-wrapper {\n          .answer-answer {\n            margin-left: var(--spacing);\n          }\n\n          &::before {\n            min-width: 2.3rem;\n            min-height: 2.3rem;\n            width: 2.3rem;\n            height: 2.3rem;\n          }\n        }\n\n        .answer-letter {\n          min-width: 2.8rem;\n          min-height: 2.8rem;\n          width: 2.8rem;\n          height: 2.8rem;\n          display: flex;\n        }\n      }\n\n      .question-feedback-content {\n        font-size: 1.6rem;\n      }\n\n      .points,\n      .question-feedback {\n        max-width: unset;\n      }\n    }\n\n    .step-card-footer .controls, .detailed-solution {\n      display: none;\n    }\n\n    .question-stem,\n    .question-feedback-content,\n    .question-info,\n    .exercise-context {\n      line-height: 2rem;\n    }\n\n    .question-info {\n      font-weight: bold;\n      font-size: 1.2rem;\n    }\n\n    .question-id {\n      font-weight: 400;\n      font-size: 1.2rem;\n    }\n\n    .question-stem {\n      color: ${colors.palette.neutralDarker};\n      font-weight: bold;\n      font-size: 1.6rem;\n    }\n\n  }\n`;\n","import React from 'react';\nimport scrollToElement from 'scroll-to-element';\nimport styled, { createGlobalStyle, css } from 'styled-components';\nimport { Answer, ExerciseData, ID, QuestionState, StepBase, StepWithData } from '../../../src/types';\nimport { InnerStepCard, OuterStepCard, TaskStepCard, TaskStepCardProps } from '../Card';\nimport { Content } from '../Content';\nimport { ExerciseQuestion } from '../ExerciseQuestion';\nimport { typesetMath } from '../../helpers/mathjax';\nimport { ExerciseToolbar, StyledToolbar } from '../ExerciseToolbar';\nimport { breakpoints } from '../../theme';\nimport { ExerciseHeaderIcons } from '../ExerciseHeaderIcons';\nimport { TypesetMathContext } from '../../hooks/useTypesetMath';\nimport { exerciseStyles } from './styles';\n\nconst StyledTaskStepCard = styled(TaskStepCard)`\n  font-size: calc(1.8rem * var(--content-text-scale));\n  line-height: calc(2.8rem * var(--content-text-scale));\n`;\n\nconst GlobalStyle = createGlobalStyle`\n  :root {\n    --content-text-scale: 1;\n  }\n`;\n\nconst ToolbarWrapper = styled.div<{\n  desktopToolbarEnabled: boolean;\n  mobileToolbarEnabled: boolean;\n}>`\n  ${props => props.desktopToolbarEnabled && css`\n    ${breakpoints.desktop`\n      ${StyledTaskStepCard} {\n        margin-left: 6.8rem;\n      }\n    `}\n    ${breakpoints.tablet`\n      ${StyledTaskStepCard} {\n        margin-left: 4.8rem;\n      }\n    `}\n    ${breakpoints.mobile`\n      ${StyledTaskStepCard} {\n        margin-left: 0;\n      }\n    `}\n  `}\n\n  ${props => props.mobileToolbarEnabled && css`\n    ${breakpoints.mobile`\n      ${StyledToolbar} + ${OuterStepCard} ${InnerStepCard} {\n        border-top-left-radius: 0;\n        border-top-right-radius: 0;\n      }\n    `}\n  `}\n`;\n\nconst TaskStepCardWithToolbar = (props: React.PropsWithChildren<TaskStepCardProps> &\n  Pick<ExerciseBaseProps, 'exerciseIcons'> & {\n    desktopToolbarEnabled: boolean;\n    mobileToolbarEnabled: boolean;\n    overlayChildren?: React.ReactNode;\n  }\n) => (\n  <ToolbarWrapper\n    desktopToolbarEnabled={props.desktopToolbarEnabled}\n    mobileToolbarEnabled={props.mobileToolbarEnabled}\n  >\n    <ExerciseToolbar icons={props.exerciseIcons} />\n    <StyledTaskStepCard overlayChildren={props.overlayChildren} {...props} />\n  </ToolbarWrapper>\n);\n\nconst Preamble = ({ exercise }: { exercise: ExerciseData }) => {\n  return (\n    <>\n      {exercise.context &&\n        <Content className=\"step-card-body exercise-context\"\n          block html={exercise.context} />}\n\n      {exercise.stimulus_html &&\n        <Content className=\"step-card-body exercise-stimulus\"\n          block html={exercise.stimulus_html} />}\n    </>\n  );\n};\n\ninterface ExerciseIconLocation {\n  desktop: boolean;\n  mobile: boolean;\n}\n\ninterface ExerciseIcon {\n  location?: {\n    /**\n     * @default {\n     *   desktop: true,\n     *   mobile: false\n     * }\n     **/\n    header?: ExerciseIconLocation;\n    /**\n     * @default {\n     *   desktop: false,\n     *   mobile: true\n     * }\n     **/\n    toolbar?: ExerciseIconLocation;\n  }\n}\n\nexport interface ExerciseIcons {\n  /** An object containing a URL for the errata form for this exercise and settings for rendering the icon. */\n  errata?: ExerciseIcon & { url: string };\n  /** An object containing a URL for textbook content relevant to the exercise and settings for rendering the icon. */\n  topic?: ExerciseIcon & { url: string };\n  /** An object of settings for rendering the info icon that describes the exercise type (multiple-choice, two-step, etc.) */\n  info?: ExerciseIcon;\n}\n\nexport interface ExerciseBaseProps {\n  /** An object containing a Step ID and Exercise UID */\n  step: StepBase;\n  /** An exercise object from the Exercises API */\n  exercise: ExerciseData;\n  numberOfQuestions: number;\n  /** The current question index. For multipart questions this is the first question number.  */\n  questionNumber: number;\n  /** A boolean that enables showing the amount of attempts remaining. */\n  hasMultipleAttempts: boolean;\n  /** A callback with the question_id when the Submit/Re-submit button is clicked. */\n  hasUnlimitedAttempts: boolean;\n  /** A boolean that enables labeling for unlimited attempts. */\n  onAnswerSave: (question_id: number) => void;\n  /** A callback with the current question index when the Next/Continue button is clicked. */\n  onNextStep: (currentIndex: number) => void;\n  /** A boolean that enables labeling the correct answer and the selected incorrect answer */\n  labelAnswers?: boolean;\n  /** A boolean that enables always showing every answer feedback_html field. */\n  show_all_feedback?: boolean;\n  /** The question number to scroll into view when the component renders. */\n  scrollToQuestion?: number;\n  /** An object containing data for how to render the following icons:\n   * - An errata icon linking to the errata/feedback form\n   * - An info icon describing the exercise type (multiple-choice, two-step, etc.)\n   * - A topic icon linking to the relevant textbook location\n   */\n  exerciseIcons?: ExerciseIcons;\n  hasFeedback?: boolean;\n}\n\nexport interface ExerciseWithStepDataProps extends ExerciseBaseProps {\n  /** A Tutor Step object */\n  step: StepWithData;\n  canAnswer: boolean;\n  needsSaved: boolean;\n  apiIsPending: boolean;\n  onAnswerChange: (answer: Answer) => void;\n  canUpdateCurrentStep: boolean;\n  answer_id_order?: ID[];\n}\n\nexport interface ExerciseWithQuestionStatesProps extends ExerciseBaseProps {\n  questionStates: { [key: ID]: QuestionState };\n  /** A callback with the IDs of the answer and question */\n  onAnswerChange: (answer: Omit<Answer, 'id'> & { id: number, question_id: number }) => void;\n}\n\nexport interface OverlayProps {\n  overlayChildren?: React.ReactNode;\n}\n\nexport const Exercise = styled(({\n  numberOfQuestions,\n  questionNumber,\n  step,\n  exercise,\n  show_all_feedback,\n  scrollToQuestion,\n  exerciseIcons,\n  overlayChildren,\n  labelAnswers = true,\n  previewMode = false,\n  showScoring = false,\n  rightSideSlot,\n  ...props\n}: {\n  className?: string,\n  previewMode?: boolean,\n  showScoring?: boolean,\n  rightSideSlot?: React.ReactNode,\n} & (ExerciseWithStepDataProps | ExerciseWithQuestionStatesProps) & OverlayProps) => {\n  const legacyStepRender = 'feedback_html' in step;\n  const questionsRef = React.useRef<Array<HTMLDivElement>>([]);\n  const container = React.useRef<HTMLDivElement>(null);\n  const [questionStates, setQuestionStates] =\n    React.useState<{ [key: ID]: QuestionState }>('questionStates' in props ? props['questionStates'] : {});\n\n\n  const handleScoringChange = (questionId: ID, score: number) => {\n    setQuestionStates(prev => ({\n      ...prev,\n      [questionId]: {\n        ...prev[questionId],\n        scoring: { score, maxScore: prev[questionId]?.scoring?.maxScore }\n      }\n    }));\n  };\n\n  const typesetExercise = React.useCallback(() => {\n    if (container.current) {\n      typesetMath(container.current);\n    }\n  }, []);\n\n  React.useEffect(() => {\n    const el = scrollToQuestion && questionsRef.current[scrollToQuestion];\n    if (el) {\n      scrollToElement(el);\n    }\n  }, [scrollToQuestion, exercise]);\n\n  const desktopToolbarEnabled = Object.values(exerciseIcons || {}).some(({ location }) => location?.toolbar?.desktop);\n  const mobileToolbarEnabled = Object.values(exerciseIcons || {}).some(({ location }) => location?.toolbar?.mobile);\n\n  const { totalScoring, isGraded } = React.useMemo(() => {\n    const totalScoring = { score: 0, maxScore: 0 };\n    let isGraded = true;\n\n    for (const q of exercise.questions) {\n      const scoring = questionStates[q.id]?.scoring;\n\n      if (!scoring?.score || !scoring?.maxScore) {\n        isGraded = false;\n        break;\n      } else {\n        totalScoring.score += scoring.score;\n        totalScoring.maxScore += scoring.maxScore;\n      }\n    }\n    return { totalScoring, isGraded };\n  }, [exercise.questions, questionStates]);\n\n  return <TypesetMathContext.Provider value={typesetExercise}>\n    <GlobalStyle />\n    <TaskStepCardWithToolbar\n      step={step}\n      questionNumber={questionNumber}\n      numberOfQuestions={legacyStepRender ? numberOfQuestions : exercise.questions.length}\n      rightHeaderChildren={exerciseIcons ? <ExerciseHeaderIcons exercise={exercise} icons={exerciseIcons} /> : null}\n      showTotalQuestions={legacyStepRender}\n      desktopToolbarEnabled={desktopToolbarEnabled}\n      mobileToolbarEnabled={mobileToolbarEnabled}\n      {...(exerciseIcons ? { exerciseIcons: exerciseIcons } : null)}\n      className={props.className}\n      showScoring={showScoring}\n      isGraded={isGraded}\n      totalScoring={legacyStepRender && 'scoring' in step ? step.scoring : totalScoring}\n      overlayChildren={overlayChildren}\n    >\n      <div ref={container} >\n        <Preamble exercise={exercise} />\n\n        {exercise.questions.map((q, i) => {\n          const state = { ...(legacyStepRender ? step : props['questionStates'][q.id]) };\n          return (\n            <ExerciseQuestion\n              {...props}\n              {...{ ...state, available_points: undefined }}\n              ref={(el: HTMLDivElement) => questionsRef.current[questionNumber + i] = el}\n              exercise_uid={exercise.uid}\n              key={q.id}\n              question={q}\n              questionNumber={questionNumber + i}\n              choicesEnabled={state.canAnswer}\n              displaySolution={true}\n              detailedSolution={state.solution?.content_html}\n              show_all_feedback={show_all_feedback}\n              labelAnswers={labelAnswers}\n              tableFeedbackEnabled={show_all_feedback && !legacyStepRender}\n              canUpdateCurrentStep={\n                // misleading prop name, we want to show a continue button for completed questions\n                // that aren't the last question, which requires this prop to be true\n                'canUpdateCurrentStep' in props ?\n                  props.canUpdateCurrentStep : !(i + 1 === exercise.questions.length)\n              }\n              previewMode={previewMode}\n              rightSideSlot={\n                React.isValidElement(rightSideSlot)\n                  ? React.cloneElement(\n                    rightSideSlot,\n                    {\n                      key: q.id,\n                      score: questionStates[q.id]?.scoring?.score,\n                      maxScore: questionStates[q.id]?.scoring?.maxScore,\n                      onChange: (score: number) => handleScoringChange(q.id, score)\n                    }\n                  )\n                  : undefined\n              }\n            />\n          )\n        }\n        )}\n      </div>\n    </TaskStepCardWithToolbar>\n  </TypesetMathContext.Provider>;\n})`\n  ${exerciseStyles}\n`;\n","const SvgComponent = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n  <path d=\"M14.556 2.09149C15.2296 1.78355 16 2.26721 16 2.99824V10.5951C16 10.9241 15.8362 11.2328 15.5605 11.4188C14.4229 12.1864 13.2007 12.6956 11.6715 12.6956C9.53267 12.6956 8.12768 11.6087 6.42651 11.6087C4.81213 11.6087 3.69241 11.923 2.79365 12.3V15.25C2.79365 15.6642 2.45254 16 2.03175 16H1.52381C1.10302 16 0.761905 15.6642 0.761905 15.25V3.18577C0.301492 2.86952 0 2.34455 0 1.74999C0 0.75924 0.836349 -0.0391985 1.852 0.00148899C2.75575 0.0376765 3.49578 0.75049 3.55203 1.63912C3.56854 1.8998 3.52632 2.1488 3.43819 2.37543C4.09648 2.13699 4.80613 1.99999 5.59835 1.99999C7.73718 1.99999 9.14216 3.08696 10.8433 3.08696C12.1289 3.08696 13.4659 2.5899 14.556 2.09149ZM2.79365 4.20718V6.40999C3.71429 6.07656 4.41841 5.85281 5.13016 5.75656V3.51999C4.38413 3.5878 3.84635 3.82593 2.79365 4.20718ZM9.80317 4.49437C8.96454 4.34837 8.21949 4.05752 7.46667 3.82749V5.93437C8.23413 6.14393 8.9767 6.44824 9.80317 6.63156V4.49437ZM5.13016 5.75656V7.94531C6.1713 7.85224 6.84159 7.92546 7.46667 8.06406V5.93437C6.66517 5.71452 5.98791 5.6399 5.13016 5.75656ZM7.46667 10.2012C8.30279 10.3466 9.04546 10.6365 9.80317 10.8681V8.76156C9.03248 8.55074 8.29397 8.24749 7.46667 8.06406V10.2012ZM2.79365 10.6906C3.54349 10.4284 4.31079 10.2581 5.13016 10.1731V7.94531C4.30127 8.01874 3.62667 8.19656 2.79365 8.48781V10.6906ZM14.4762 3.76562C13.8 4.04218 12.9971 4.31687 12.1397 4.4678V6.71499C13.0067 6.57874 13.7279 6.27437 14.4762 5.96843V3.76562ZM14.4762 10.3269V8.12406C13.7717 8.56781 12.9276 8.83062 12.1397 8.93718V11.1741C12.9356 11.0997 13.679 10.8291 14.4762 10.3269ZM9.80317 6.63156V8.76156C10.6179 8.9845 11.283 9.05349 12.1397 8.93718V6.71499C11.3143 6.84584 10.5542 6.79862 9.80317 6.63156Z\" fill=\"currentColor\"/>\n  </svg>\n);\nexport default SvgComponent;\n","import styled, { css } from 'styled-components';\nimport { colors, breakpoints } from '../theme';\nimport FlagIcon from '../assets/flag';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCheck } from '@fortawesome/free-solid-svg-icons/faCheck';\nimport { faXmark } from '@fortawesome/free-solid-svg-icons/faXmark';\nimport { faCircle } from '@fortawesome/free-solid-svg-icons/faCircle';\nimport { faP, faQuestion } from '@fortawesome/free-solid-svg-icons';\n\nconst ProgressBarWrapper = styled.nav`\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap;\n  gap: 1rem;\n  padding: 2rem;\n\n  ${breakpoints.mobile`\n    padding: 1.6rem 0.8rem;\n  `}\n`;\n\nconst StyledItemWrapper = styled.span`\n  display: flex;\n  align-items: center;\n  position: relative;\n\n  &:last-child {\n    margin-right: 0;\n  }\n`;\n\nconst handleVariant = (variant: ProgressBarItemVariant) => {\n  switch (variant) {\n    case 'isStatus':\n      return css`\n        color: ${colors.palette.white};\n        background-color: ${colors.palette.neutralDarker};\n      `;\n    case 'isCorrect':\n      return css`\n        color: ${colors.answer.correct};\n        background-color: #E8F4D8;\n      `;\n    case 'isIncorrect':\n      return css`\n        color: ${colors.answer.incorrect};\n        background-color: #F8E8EA;\n      `;\n    case 'isIncomplete':\n      return css`\n        background-color: ${colors.palette.neutralBright};\n      `;\n    case 'isPartialCredit':\n      return css`\n        color: ${colors.answer.partialCredit};\n        background-color: ${colors.palette.yellow};\n      `;\n    default:\n      return css`\n        background-color: ${colors.palette.neutralLight};\n      `;\n  }\n};\n\nconst shadowCss = 'box-shadow: 0px 1px 4px 0px #00000066;';\n\nexport const StyledItem = styled.button<{ variant: ProgressBarItemVariant, isActive: boolean }>`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: ${props => props.isActive ? '4rem' : '3.2rem'};\n  height: ${props => props.isActive ? '4rem' : '3.2rem'};\n  border: 0;\n  border-radius: 50%;\n  margin: ${props => props.isActive ? '0' : '0 0.3rem'};\n  font-size: 1.6rem;\n  font-weight: bold;\n  cursor: pointer;\n  color: ${colors.palette.neutralDarker};\n  ${props => props.isActive ? css`\n    ${shadowCss}\n    & + [data-icon] {\n      bottom: 0;\n      right: 0;\n    }\n  ` : null}\n  ${props => handleVariant(props.variant)}\n  &:hover {\n    ${shadowCss}\n  }\n`;\n\nconst StyledFontAwesomeIcon = styled(FontAwesomeIcon)`\n  color: ${props => props.color};\n  position: absolute;\n  bottom: 0.4rem;\n  right: 0.3rem;\n  height: 0.8rem;\n  width: 0.8rem;\n  font-size: 1.2rem;\n  border-radius: 50%;\n`;\n\nconst StyledFeedbackNotification = styled.button<{ isActive: boolean }>`\n  background-color: ${colors.palette.mediumBlue};\n  border: 0.2rem solid ${colors.palette.white};\n  position: absolute;\n  top: 0.1rem;\n  left: ${props => props.isActive ? '3.8rem' : '3.2rem'};\n  height: 1rem;\n  width: 1rem;\n  padding: 0.2rem;\n  border-radius: 80%;\n`;\n\nconst ItemIcon = ({ variant }: { variant: ProgressBarItemVariant }) => {\n  if (variant === 'isStatus') {\n    return null;\n  }\n\n  const defaultPadding = '0.1rem';\n\n  const variantData = {\n    isCorrect: {\n      icon: faCheck,\n      background: colors.answer.correct,\n      color: colors.palette.white,\n      padding: defaultPadding,\n      label: 'Correct',\n    },\n    isIncorrect: {\n      icon: faXmark,\n      background: colors.answer.incorrect,\n      color: colors.palette.white,\n      padding: defaultPadding,\n      label: 'Incorrect',\n    },\n    isIncomplete: {\n      icon: faQuestion,\n      background: colors.answer.neutral,\n      color: colors.palette.white,\n      padding: defaultPadding,\n      label: 'Incomplete'\n    },\n    isPartialCredit: {\n      icon: faP,\n      background: colors.answer.partialCredit,\n      color: colors.palette.white,\n      padding: '0.1rem 0.1rem 0.1rem 0.2rem',\n      label: 'Partial credit'\n    },\n    null: {\n      icon: faCircle,\n      background: colors.answer.neutral,\n      color: colors.answer.neutralDark,\n      padding: defaultPadding,\n      label: 'Not yet graded'\n    }\n  }[String(variant)];\n\n  if (!variantData) return null;\n\n  return <StyledFontAwesomeIcon\n    icon={variantData.icon}\n    color={variantData.color}\n    style={{ background: variantData.background, padding: variantData.padding }}\n    height='16px'\n    width='16px'\n    aria-label={variantData.label}\n    aria-hidden={undefined}\n  />;\n}\n\nexport interface ProgressBarProps<S extends {variant: ProgressBarItemVariant, hasFeedback?: boolean}> {\n  steps: S[];\n  activeIndex: number | null;\n  goToStep: (index: number, step: S) => void;\n}\n\nexport interface ProgressBarItemProps<S> {\n  index: number;\n  isActive: boolean;\n  step: S;\n  goToStep: (index: number, step: S) => void;\n}\n\nexport type ProgressBarItemVariant = 'isCorrect' | 'isIncorrect' | 'isStatus' | 'isIncomplete' | 'isPartialCredit' | null;\n\nexport const ProgressBarItem = <S extends {variant: ProgressBarItemVariant; hasFeedback?: boolean}>({index, isActive, step, goToStep}: ProgressBarItemProps<S>) =>\n  <StyledItemWrapper>\n    {step.hasFeedback && step.variant && step.variant !== 'isStatus' \n      ? <StyledFeedbackNotification isActive={isActive} aria-label={`Question ${index + 1} - Feedback`} /> \n      : null\n    }\n    <StyledItem\n      variant={step.variant}\n      isActive={isActive}\n      onClick={() => goToStep(index, step)}\n      aria-current={isActive ? 'location' : 'false'}\n      aria-label={step.variant === 'isStatus' ? 'Assignment status' : `Question ${index + 1}` }\n    >\n      {step.variant === 'isStatus' ? <FlagIcon /> : index + 1}\n    </StyledItem>\n    <ItemIcon variant={step.variant} />\n  </StyledItemWrapper>;\n\nexport const ProgressBar = <S extends {variant: ProgressBarItemVariant; hasFeedback?: boolean}>({ steps, activeIndex, goToStep }: ProgressBarProps<S>) =>\n  <ProgressBarWrapper aria-label=\"Breadcrumbs\">\n    {steps.map((step, index) => <ProgressBarItem\n      key={index}\n      index={index}\n      isActive={index === activeIndex}\n      step={step}\n      goToStep={goToStep}\n    />)}\n  </ProgressBarWrapper>;\n","import { BulletList } from \"react-content-loader\";\nimport { colors } from \"../../src/theme\";\nimport styled from \"styled-components\";\n\nconst Wrapper = styled.div`\n  max-width: 1000px;\n  @media(min-width: 960px) {\n    // Around the height of a multiple choice with 4 options\n    min-height: 53.8rem;\n  }\n  padding: 2rem;\n  margin: 2rem;\n  border: 1px solid ${colors.palette.light};\n  border-radius: 0.25rem;\n  background-color: white;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  > svg {\n    max-width: 600px;\n    flex-grow: 1;\n  }\n`;\n\nexport const Loader = () => <Wrapper><BulletList uniqueKey=\"OSLoader\" /></Wrapper>;\n","import { colors } from '../../theme';\nimport styled from \"styled-components\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\n\nexport const StyledContainer = styled.div`\n  display: flex;\n  width: fit-content;\n`;\n\nexport const StyledButton = styled.button`\n    width: 7.4rem;\n    height: 8.7rem;\n    color: white;\n    border: none;\n\n    &:hover {\n      box-shadow: 0 0.1rem 0.4rem 0 #00000066;\n    }\n    \n    span {\n        line-height: 1.3rem;\n        font-size: 1.4rem;\n        font-weight: bold;\n    }\n\n    &.include {\n        background-color: ${colors.palette.mediumBlue};\n        padding-top: 1.4rem;\n    }\n\n    &.remove {\n        background-color: ${colors.palette.orange};\n        padding-top: 1.4rem;\n    }\n\n    &.details {\n        background-color: ${colors.palette.neutralDarker};\n    }\n`;\n\nexport const StyledIcon = styled(FontAwesomeIcon)`\n    border-radius: 50%;\n    background-color: ${colors.palette.white};\n    vertical-align: middle;\n    position: relative;\n    bottom: 0.5rem;\n    font-weight: 900;\n    line-height: 1.4rem;\n\n\n    &.include {\n        color: ${colors.palette.mediumBlue};\n    }\n\n    &.remove {\n        color: ${colors.palette.orange};\n    }\n\n    &.details {\n        color: ${colors.palette.neutralDarker};\n    }\n`;\n","import React from \"react\";\nimport { ExerciseData, ExerciseQuestionData, StepBase, QuestionState, ID } from \"src/types\";\nimport { Exercise } from \"./Exercise\";\nimport styled from \"styled-components\";\n\nconst StyledExercise = styled(Exercise)<{ showAllFeedback?: boolean; showCorrectAnswer?: boolean }>`\n  ${({ showAllFeedback }) => !showAllFeedback && `\n    .step-card-footer {\n      display: none;\n    }\n  `}\n  ${({ showCorrectAnswer }) => !showCorrectAnswer && `\n    .answer-answer {\n      font-weight: normal;\n    }\n  `}\n`;\n\nexport interface ExercisePreviewProps {\n  exercise: ExerciseData;\n  selected?: boolean;\n  showAllFeedback?: boolean;\n  showChosenAnswer?: boolean;\n  showCorrectAnswer?: boolean;\n  labelAnswers?: boolean;\n  overlayChildren?: React.ReactNode;\n  questionStates?: { [key: ID]: QuestionState };\n  showScoring?: boolean;\n  rightSideSlot?: React.ReactNode;\n}\n\nexport const ExercisePreview = ({\n  exercise,\n  selected,\n  showAllFeedback = false,\n  showChosenAnswer = false,\n  showCorrectAnswer = false,\n  labelAnswers = false,\n  showScoring = false,\n  overlayChildren,\n  questionStates,\n  rightSideSlot\n}: ExercisePreviewProps) => {\n\n  const hideAnswerFeedback = (exercise: ExerciseData) => {\n    exercise.questions.map(question =>\n      question.answers.map(a => {\n        a.feedback_html = '';\n        a.correctness = showCorrectAnswer ? a.correctness : undefined;\n      }));\n    return exercise;\n  };\n\nconst exercisePreviewProps = (exercise: ExerciseData) => {\n    const formatAnswerData = (questions: ExerciseQuestionData[]) => questions.map((q) => {\n      // Note: will only work as long as both ExerciseData and QuestionState use the same type for the IDs\n      const questionState = (questionStates ?? {})[q.id];\n\n      return {\n        id: q.id,\n        answer_id: (showChosenAnswer ? questionState : undefined)?.answer_id ?? '',\n        correct_answer_id: (q.answers.find((a) => a.correctness === '1.0')?.id || ''),\n        content_html:\n          showAllFeedback &&\n          q.collaborator_solutions?.find(solution => solution.solution_type === 'detailed')?.content_html,\n        scoring: questionState?.scoring ?? {},\n      }\n    });\n\n    const questionStateFields = formatAnswerData(exercise.questions).reduce(\n      (acc, answer) => {\n        const { id, answer_id, correct_answer_id, content_html, scoring } = answer;\n        return {\n          ...acc,\n          [id]: {\n            answer_id,\n            correct_answer_id,\n            is_completed: showCorrectAnswer,\n            solution: {\n              content_html,\n            },\n            scoring\n          }\n        };\n      }, {}\n    );\n\n    const step: StepBase = {\n      id: 1,\n      uid: exercise.uid,\n      available_points: '1.0',\n    };\n\n    return {\n      canAnswer: true,\n      needsSaved: true,\n      hasMultipleAttempts: false,\n      hasUnlimitedAttempts: false,\n      onAnswerChange: () => undefined,\n      onAnswerSave: () => undefined,\n      onNextStep: () => undefined,\n      apiIsPending: false,\n      canUpdateCurrentStep: false,\n      step: step,\n      questionNumber: exercise.number as number,\n      numberOfQuestions: exercise.questions.length,\n      questionStates: questionStateFields,\n      labelAnswers,\n      show_all_feedback: showAllFeedback,\n    };\n  };\n\n  return (\n    <StyledExercise\n      exercise={showAllFeedback ? exercise : hideAnswerFeedback(exercise)}\n      className={`preview-card ${selected ? 'is-selected' : ''}`}\n      previewMode\n      showScoring={showScoring}\n      overlayChildren={overlayChildren}\n      {...exercisePreviewProps(exercise)}\n      rightSideSlot={rightSideSlot}\n    />\n  );\n};\n","import React from \"react\";\nimport { faPlus, faMinus, faEllipsisH } from \"@fortawesome/free-solid-svg-icons\";\nimport { StyledContainer, StyledButton, StyledIcon } from \"./styles\";\n\nexport interface IncludeRemoveQuestionProps {\n  // Prop that defines the variant of the button\n  buttonVariant: 'include' | 'remove';\n  // Method invoked when the include button is clicked\n  onIncludeHandler: () => void;\n  // Method invoked when the remove button is clicked\n  onRemoveHandler: () => void;\n  // Method invoked when the details button is pressed\n  onClickDetails?: () => void;\n}\n\nexport const IncludeRemoveQuestion = (\n  { buttonVariant, onIncludeHandler, onRemoveHandler, onClickDetails }: IncludeRemoveQuestionProps) => {\n\n  const buttonIcon = React.useMemo(() => buttonVariant === 'include' ? faPlus : faMinus, [buttonVariant]);\n  const onClickHandler = (variant: 'include' | 'remove') => {\n    switch (variant) {\n      case 'include':\n        onIncludeHandler();\n        break;\n      case 'remove':\n        onRemoveHandler();\n        break;\n    }\n  };\n\n  const generateButtonText = (string: string) => {\n    return string.charAt(0).toUpperCase() + string.slice(1) + ' question';\n  };\n\n  return (\n    <StyledContainer>\n      <StyledButton className={buttonVariant} onClick={() => onClickHandler(buttonVariant)} aria-label={buttonVariant}>\n        <StyledIcon className={buttonVariant} icon={buttonIcon} aria-label={buttonVariant + ' question'} border size=\"lg\" />\n        <span>{generateButtonText(buttonVariant)}</span>\n      </StyledButton>\n      <StyledButton className=\"details\" aria-label=\"details\" onClick={onClickDetails}>\n        <StyledIcon className=\"details\" icon={faEllipsisH} border size=\"lg\" />\n        <span>Details</span>\n      </StyledButton>\n    </StyledContainer>\n  );\n}; "],"names":["ALPHABET","isAnswerIncorrect","answer","incorrectAnswerId","id","countWords","text","words","trim","match","length","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_templateObject7","_templateObject8","_templateObject9","_templateObject10","_templateObject11","_templateObject12","_templateObject13","TypesetMathContext","React","createContext","Error","Overlay","styled","div","_taggedTemplateLiteralLoose","ScrollableContent","FloatingCloseButton","button","buttonHeight","ContentContainer","ModalWrapper","CloseIcon","_jsxs","jsxs","width","height","viewBox","xmlns","children","_jsx","x","y","rx","stroke","fill","jsx","x1","y1","x2","y2","strokeWidth","strokeLinecap","MediaModal","_ref","isOpen","onClose","modalRef","useRef","useEffect","current","focusableSelectors","join","focusableElements","querySelectorAll","firstEl","lastEl","focus","trapFocus","e","key","activeEl","document","activeElement","isShift","shiftKey","preventDefault","addEventListener","removeEventListener","onClick","role","ref","stopPropagation","tabIndex","Content","html","component","_ref$block","block","props","_objectWithoutPropertiesLoose","_excluded","typesetMath","useContext","DivOrSpan","mediaModalManager","setModalContent","_createMediaModalPort","open","content","MediaModalPortal","_React$useState","useState","setIsOpen","_React$useState2","modalContent","setContent","onKeyDown","doc","createPortal","body","_createListeners","container","handleInteraction","target","closest","type","img","querySelector","src","alt","createInteractionHandler","detach","mount","newContainer","unmount","createListeners","createMediaModalManager","forEach","_img$parentElement","createElement","getAttribute","setAttribute","classList","add","parentElement","insertBefore","appendChild","undefined","cloneElement","_extends","_Fragment","dangerouslySetInnerHTML","__html","SimpleFeedback","contentRenderer","className","classnames","Feedback","wrapperClasses","position","palette","red","danger","darkRed","lightRed","green","lightGreen","darkGreen","paleYellow","teal","blue","mediumBlue","lightBlue","neutralLightBlue","tangerine","gray","darkGray","pale","light","white","neutralLightest","neutralCool","neutralBright","neutralLighter","neutralLight","neutralMedium","neutral","neutralThin","neutralDark","neutralFeedback","neutralDarker","black","orange","yellow","colors","hover","checked","correct","incorrect","partialCredit","popover","arrowOuterColor","borderColor","card","header","background","backgroundHover","backgroundActive","freeResponse","color","layouts","BREAKPOINTS","breakpoints","css","apply","slice","call","arguments","transitions","mixins","answerColor","invertBubble","answerChecked","answerCorrect","answerIncorrect","answerHover","answerCorrectAnswer","resetText","stepCardPadding","visuallyHidden","StyledAnswerIndicator","state","AnswerIndicator","isCorrect","isIncorrect","isSelected","hasCorrectAnswer","AnswerAnswer","_props$answer","content_html","feedback_html","show_all_feedback","tableFeedbackEnabled","labelAnswers","TeacherReview","answered_count","iter","percent","selected_count","Math","round","cn","AnswerChoice","onChangeAnswer","disabled","onKeyPress","qid","feedbackId","_props$labelAnswers","ariaLabel","Fragment","correctIncorrectIcon","name","onChange","htmlFor","AnswerBody","Answer","answerId","correctAnswerId","isChecked","isAnswerChecked","correctness","isAnswerCorrect","classes","displayName","AnswersTable","idCounter","question","_props$type","correct_answer_id","correct_answer_feedback_html","previewMode","_props$show_all_feedb","answerIdOrder","instructions","hideAnswers","idOrder","feedback","questionAnswerProps","answer_id","choicesEnabled","answersHtml","answers","sort","a","b","indexOf","map","i","additionalProps","question_id","parseInt","answerProps","Object","assign","push","index","item","spliceIndex","splice","InnerStepCard","OuterStepCard","StepCardHeader","StyledUngraded","StepCardQuestion","mobile","StyledOverlay","_templateObject14","StepCard","_totalScoring$score","_totalScoring$maxScor","questionNumber","numberOfQuestions","showTotalQuestions","stepType","isHomework","availablePoints","unpadded","questionId","multipartBadge","leftHeaderChildren","rightHeaderChildren","headerTitleChildren","overlayChildren","showScoring","totalScoring","isGraded","otherProps","overlayRef","_useState","showOverlay","setShowOverlay","formattedQuestionNumber","handleOverlayFocus","useCallback","hideFocusableElements","_document$getElementB","Array","from","getElementById","el","currentOverlayRef","onMouseOver","onMouseLeave","onBlur","event","contains","relatedTarget","score","toFixed","maxScore","TaskStepCard","_ref2","step","_excluded2","task","uid","StyledButton","Button","isWaiting","waitingText","GlobalStyle","createGlobalStyle","CompletionStatusCard","CompletionHeader","h2","ButtonGroup","ScoreGroup","RetryResumeButton","CompletionStatus","_score$current","_score$saved","numberCompleted","handleContinue","handleRetry","isRetrying","allCompleted","someCompleted","buttonText","retryOrResume","onRetryResumeClick","onNextContinueClick","handleNext","saved","split","toLowerCase","StyledBodyContainer","StyledQuestion","Question","forwardRef","exerciseUid","solution","exercise_uid","context","hidePreambles","rightSideSlot","stem_html","_question$collaborato","collaborator_solutions","formats","stimulus_html","is_deleted","_question$collaborato2","displaySolution","find","s","hasSolution","QuestionHtml","hidden","displayFormats","FormatsListing","_props$html","_ref$formats","format","StepCardFooter","TextAreaErrorStyle","StyledFreeResponse","SyledQuestionStem","InfoRow","hasChildren","FreeResponseTextArea","textarea","isOverWordLimit","readOnly","RevertButton","FreeResponseInput","cancelHandler","defaultValue","infoRowChildren","isSubmitDisabled","saveHandler","submitBtnLabel","textHasChanged","wordLimit","questionProps","placeholder","baseContainer","FreeResponseDefaultContainer","FreeResponseExpandedContainer","FreeResponseText","expanded","COLLAPSED_HEIGHT","isOverflowing","ReadMoreLink","FreeResponseContainer","FreeResponseReview","free_response","setExpanded","setIsOverflowing","textRef","useLayoutEffect","scrollHeight","AttemptsRemaining","count","UnlimitedAttempts","PublishedComments","published_comments","SaveButton","willContinue","attempt_number","NextButton","canUpdateCurrentStep","ExerciseQuestion","answer_id_order","onAnswerChange","is_completed","hasMultipleAttempts","hasUnlimitedAttempts","attempts_remaining","detailedSolution","canAnswer","needsSaved","apiIsPending","onAnswerSave","onNextStep","available_points","hasFeedback","shouldContinue","setShouldContinue","MATH_MARKER_BLOCK","MATH_MARKER_INLINE","MATH_MARKED_CLASS","MATHJAX_CONFIG","extensions","showProcessingMessages","skipStartupTypeset","styles","left","right","visibility","tex2jax","displayMath","inlineMath","findUnprocessedMath","root","processedMath","findProcessedMath","filter","node","findLatexNodes","latexNodes","_i","_Array$from","formula","textContent","tagName","resolveOrWait","resolve","remainingTries","setTimeout","typesetDocumentPromise","windowImpl","Promise","MathJax","Hub","Queue","isEmpty","Typeset","_step","result","_iterator","_createForOfIteratorHelperLoose","done","value","markLatexNodesRendered","typesetLatexNodes","mathMLNodes","typesetMathMLNodes","typesetDocument","getTypesetDocument","memoize","debounce","leading","trailing","bind","cache","WeakMap","startMathJax","once","window","configuredCallback","HTML","Cookie","prefix","Configured","Register","StartupHook","script","async","head","Config","processSectionDelay","AuthorInit","StyledToolbar","desktop","ExerciseToolbar","_icons$topic","_icons$errata","icons","settings","values","some","_location$toolbar$mob","_location$toolbar","location","toolbar","_ref3","_location$toolbar$des","_location$toolbar2","topicUrl","topic","url","errataUrl","errata","href","FontAwesomeIcon","icon","faBookOpen","faTriangleExclamation","ItemWrapper","InnerWrapper","Popover","PopoverItem","wrapperProps","PopoverItemsWrapper","StyledFontAwesomeIcon","ExerciseHeaderIcons","typeExplanation","_icons$topic$location","_icons$errata$locatio","_icons$info$location","exercise","defaultHeaderLocation","items","isMultipleChoice","questions","every","q","includes","as","info","faCircleInfo","exerciseStyles","StyledTaskStepCard","ToolbarWrapper","desktopToolbarEnabled","mobileToolbarEnabled","TaskStepCardWithToolbar","exerciseIcons","Preamble","Exercise","scrollToQuestion","_ref2$labelAnswers","_ref2$previewMode","_ref2$showScoring","legacyStepRender","questionsRef","questionStates","setQuestionStates","typesetExercise","then","MATH_DATA_SELECTOR","console","warn","reject","scrollToElement","_ref4","_React$useMemo","useMemo","_questionStates$q$id","scoring","Provider","_state$solution","_questionStates$q$id2","_questionStates$q$id3","_questionStates$q$id4","_questionStates$q$id5","_createElement","isValidElement","prev","_prev$questionId","_prev$questionId$scor","_extends2","handleScoringChange","SvgComponent","d","ProgressBarWrapper","nav","StyledItemWrapper","span","shadowCss","StyledItem","isActive","variant","handleVariant","StyledFeedbackNotification","ItemIcon","defaultPadding","variantData","faCheck","padding","label","faXmark","isIncomplete","faQuestion","isPartialCredit","faP","null","faCircle","String","style","ProgressBarItem","goToStep","FlagIcon","Wrapper","StyledContainer","StyledIcon","StyledExercise","showAllFeedback","showCorrectAnswer","selected","_ref3$showAllFeedback","_ref3$showChosenAnswe","showChosenAnswer","_ref3$showCorrectAnsw","_ref3$labelAnswers","_ref3$showScoring","hideAnswerFeedback","questionStateFields","_answer_id","_q$answers$find","_q$collaborator_solut","_q$collaborator_solut2","_questionState$scorin","questionState","solution_type","reduce","acc","number","exercisePreviewProps","string","buttonVariant","onIncludeHandler","onRemoveHandler","onClickDetails","buttonIcon","faPlus","faMinus","onClickHandler","border","size","charAt","toUpperCase","faEllipsisH","BulletList","uniqueKey","activeIndex","steps"],"mappings":"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"}